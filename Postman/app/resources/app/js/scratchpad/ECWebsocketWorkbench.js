"use strict";(self.webpackChunk_postman_app_scratchpad=self.webpackChunk_postman_app_scratchpad||[]).push([[9],{12213:function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var a=s(1),n=s(3565);function i(){return a.createElement(n.default,{name:"illustration-connect-to-server"})}},12246:function(e,t,s){s.r(t),s.d(t,{ACTION_TO_BUTTON_MAP:function(){return y},APPLICATION_JAVASCRIPT:function(){return ae},APPLICATION_JSON:function(){return te},APPLICATION_OCTET_STREAM:function(){return ne},APPLICATION_XML:function(){return se},COMPOSE_MESSAGE_BODY_SUBTYPE_MAP:function(){return $},COMPOSE_MESSAGE_BODY_TYPE_MAP:function(){return J},CONNECT:function(){return E},CONNECTED:function(){return p},CONNECTING:function(){return u},CONNECTION_EVENT_TO_HANDLER_MAP:function(){return he},DISABLED_TOOLTIP_TEXT:function(){return fe},DISCONNECT:function(){return g},DISCONNECTING:function(){return m},EDITOR:function(){return oe},IDLE:function(){return d},IFRAME:function(){return le},MESSAGE_BODY_SUB_TYPE_FLOATINT32ARRAY:function(){return j},MESSAGE_BODY_SUB_TYPE_FLOATINT64ARRAY:function(){return Q},MESSAGE_BODY_SUB_TYPE_INT16ARRAY:function(){return q},MESSAGE_BODY_SUB_TYPE_INT32ARRAY:function(){return z},MESSAGE_BODY_SUB_TYPE_INT8ARRAY:function(){return K},MESSAGE_BODY_SUB_TYPE_UINT16ARRAY:function(){return Y},MESSAGE_BODY_SUB_TYPE_UINT32ARRAY:function(){return V},MESSAGE_BODY_SUB_TYPE_UINT8ARRAY:function(){return H},MESSAGE_BODY_SUB_TYPE_UINT8CLAMPEDARRAY:function(){return F},MESSAGE_BODY_TYPE_ARRAY_BUFFER:function(){return U},MESSAGE_BODY_TYPE_AUDIO:function(){return x},MESSAGE_BODY_TYPE_HEXDUMP:function(){return W},MESSAGE_BODY_TYPE_HTML:function(){return B},MESSAGE_BODY_TYPE_IMAGE:function(){return G},MESSAGE_BODY_TYPE_JSON:function(){return P},MESSAGE_BODY_TYPE_TEXT:function(){return R},MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP:function(){return ie},MESSAGE_BODY_TYPE_VIDEO:function(){return L},MESSAGE_BODY_TYPE_XML:function(){return D},MESSAGE_ICON_MAP:function(){return I},MESSAGE_PREVIEW_TRUNCATE_THRESHOLD:function(){return ue},MESSAGE_STREAM_NOTIFICATION_JUMP_TO_LATEST:function(){return _e},MESSAGE_STREAM_NOTIFICATION_NEW:function(){return Te},MESSAGE_TYPE_FILTER_LABELS:function(){return k},MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP:function(){return re},RECONNECTING:function(){return h},TEXT_HTML:function(){return ee},TEXT_PLAIN:function(){return Z},TYPED_ARRAY_CONSTRUCTOR_MAP:function(){return X},WEBSOCKET_ABORT_MESSAGE:function(){return M},WEBSOCKET_ALL_MESSAGES:function(){return N},WEBSOCKET_CONNECTED_MESSAGE:function(){return b},WEBSOCKET_CONNECTION_CLOSE_CODES:function(){return ge},WEBSOCKET_CONNECTION_HEADERS:function(){return o},WEBSOCKET_CONNECTION_QUERY_PARAMS:function(){return c},WEBSOCKET_CONNECTION_SETTINGS:function(){return l},WEBSOCKET_DISCONNECTED_MESSAGE:function(){return v},WEBSOCKET_ERROR_MESSAGE:function(){return O},WEBSOCKET_HIDDEN_MESSAGE:function(){return A},WEBSOCKET_INCOMING_MESSAGE:function(){return f},WEBSOCKET_MESSAGES:function(){return i},WEBSOCKET_MESSAGE_READABLE:function(){return de},WEBSOCKET_MESSAGE_STREAM_STATUS:function(){return ye},WEBSOCKET_MESSAGE_SUPPORTED_MEDIA_TYPES:function(){return ce},WEBSOCKET_MESSAGE_VIEWER_MAP:function(){return pe},WEBSOCKET_META_MESSAGES:function(){return w},WEBSOCKET_OUTGOING_MESSAGE:function(){return T},WEBSOCKET_RECONNECTING_MESSAGE:function(){return C},WEBSOCKET_SCRIPTS:function(){return r},WEBSOCKET_STATUS_TO_ACTION_MAP:function(){return S},WEBSOCKET_STATUS_TO_BADGE_MAP:function(){return _},WS_CONNECTION_CONFIG:function(){return me},WS_CONNECTION_STATS_TEMPLATE:function(){return Ee},WS_REQUEST_ENABLED_DESKTOP_AGENT_VERSION:function(){return Se}});var a=s(3583),n=s.n(a);const i="messages",r="scripts",o="headers",l="settings",c="queryParams",d="idle",p="connected",u="connecting",h="reconnecting",m="disconnecting",E="connect",g="disconnect",S={[d]:E,[u]:g,[p]:g,[m]:E,[h]:g},y={[E]:{label:"Connect",handler:"connect"},[g]:{label:"Disconnect",handler:"disconnect"}},_={[d]:{label:"Disconnected",type:"critical"},[u]:{label:"Connecting",type:"info"},[p]:{label:"Connected",type:"success"},[m]:{label:"Disconnecting",type:"info"},[h]:{label:"Reconnecting",type:"info"}},T="outgoing",f="incoming",b="meta_connected",v="meta_disconnected",C="meta_reconnecting",M="meta_abort",O="meta_error",A="hidden",N="all",w=[b,v,C,M,O],I={[T]:{name:"icon-direction-ascend-small",color:"content-color-warning",size:"small"},[f]:{name:"icon-direction-descend-small",color:"content-color-info",size:"small"},[O]:{name:"icon-state-error-stroke",color:"content-color-error",size:"large"},[b]:{name:"icon-state-success-stroke",color:"content-color-success",size:"large"},[C]:{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"},[M]:{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"},[v](e){return e?{name:"icon-state-info-stroke",color:"content-color-primary",size:"large"}:{name:"icon-state-error-stroke",color:"content-color-error",size:"large"}}},k={[N]:"All Messages",[T]:"Sent",[f]:"Received"},R="text",P="postman_json",D="xml",B="html",W="hexdump",L="video",x="audio",G="image",U="array-buffer",K="Int8Array",H="Uint8Array",F="Uint8ClampedArray",q="Int16Array",Y="Uint16Array",z="Int32Array",V="Uint32Array",j="Float32Array",Q="Float64Array",J={[R]:"Text",[P]:"JSON",[D]:"XML",[B]:"HTML",[U]:"Array Buffer"},$={[K]:[K],[H]:[H],[F]:[F],[q]:[q],[Y]:[Y],[z]:[z],[V]:[V],[j]:[j],[Q]:[Q]},X={[K]:{constructor:Int8Array,multiple:1},[H]:{constructor:Uint8Array,multiple:1},[F]:{constructor:Uint8ClampedArray,multiple:1},[q]:{constructor:Int16Array,multiple:2},[Y]:{constructor:Uint16Array,multiple:2},[z]:{constructor:Int32Array,multiple:4},[V]:{constructor:Uint32Array,multiple:4},[j]:{constructor:Float32Array,multiple:4},[Q]:{constructor:Float64Array,multiple:8}},Z="text/plain",ee="text/html",te="application/json",se="application/xml",ae="application/javascript",ne="application/octet-stream",ie={[R]:Z,[B]:ee,[P]:te,[D]:se,[U]:ne},re={[Z]:R,[ee]:B,[te]:P,[se]:D,[ne]:W},oe="editor",le="iframe",ce=new Set([L,x,G]),de=new Set([Z,ee,te,se,ae]),pe={[oe]:de,[le]:ce},ue=200,he={open:"onOpen",upgrade:"onUpgrade",message:"onMessage",close:"onClose",error:"onError",reconnect:"onReconnect",end:"onEnd"},me=[{id:"handshakeTimeout",title:"Handshake request timeout",description:"Set how long the handshake request should wait before timing out in milliseconds. To never time out, set to 0.",inputFieldType:"input",inputType:"number",defaultValue:0},{id:"retryCount",title:"Reconnection attempts",description:"Maximum reconnection attempts when the connection closes abruptly.",inputFieldType:"input",inputType:"number",defaultValue:0},{id:"retryDelay",title:"Reconnection intervals",description:"Interval between each reconnection attempt in milliseconds.",inputFieldType:"input",inputType:"number",defaultValue:5e3},{id:"maxPayload",title:"Maximum message size",description:"Maximum allowed message size in MB. To receive messages of any size, set to 0.",inputFieldType:"input",inputType:"number",defaultValue:10}],Ee=[{section:"Connection Details",dataFields:[{key:"connectedOn",label:"Connected",formatter:e=>n()(e).format("MMM Do YYYY,  HH:mm")},{label:"Protocol",key:"protocol"},{label:"Extensions",key:"extensions"}]}],ge={1e3:{code:1e3,name:"Normal Closure",description:"Connection was closed successfully."},1001:{code:1001,name:"Going Away",description:"Either because of a server failure or because the client is navigating away."},1002:{code:1002,name:"Protocol Error",description:"Endpoint terminated the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"Endpoint received data of a type it cannot accept."},1005:{code:1005,name:"No Status Received",description:"Missing status code even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"No close frame was received."},1007:{code:1007,name:"Invalid Frame",description:"Endpoint received inconsistent data."},1008:{code:1008,name:"Policy Violation",description:"Endpoint received a message that violates its policy."},1009:{code:1009,name:"Message too big",description:"Endpoint received a data frame that was too large."},1010:{code:1010,name:"Missing Extension",description:"Server did not negotiate one or more extension expected by client."},1011:{code:1011,name:"Server Error",description:"Internal server error while operating."},1012:{code:1012,name:"Service Restart",description:"Server is restarting."},1013:{code:1013,name:"Try Again Later",description:"Temporary server error while operating."},1014:{code:1014,name:"Bad Gateway",description:"Server acting as gateway received an invalid response."},1015:{code:1015,name:"TLS Handshake",description:"Failure while performing the TLS handshake."},unknown(e,t){return{code:e||"Unknown",name:"Error",description:t||"Connection was closed due to an unknown error."}}},Se="0.3.5",ye={Ready:"ready",Loading:"loading",Error:"error",Empty:"empty"},_e="jump-to-latest",Te="new-messages",fe={noPermission:"You don't have permission to connect with a WebSocket server in this workspace.",notMember:"Only workspace members can connect with a WebSocket server. Join this workspace to complete this action.",emptyURL:"URL cannot be empty",nonWsAgent:"Switch to Postman Desktop Agent to connect with a WebSocket server.",agentNotConnected:"Make sure the Desktop Agent is installed and running.",oldAgent:"Youâ€™re using an older version of Postman Desktop Agent which does not support WebSocket requests. Update the Desktop Agent and try again."}},12244:function(e,t,s){s.r(t),s.d(t,{arrayBufferToString:function(){return f},createMessage:function(){return w},deserializeMessageData:function(){return W},deserializeMessages:function(){return L},getConnectionCloseInfo:function(){return N},getHeadersKeySuggestions:function(){return R},getHistoryMeatFromRequest:function(){return P},getMessagePreview:function(){return A},isConnectDisabled:function(){return k},isNormalConnectionClose:function(){return I},parseIncomingOrOutgoingMessage:function(){return x},parseSentOrReceviedMessageEvent:function(){return G},prepareHandshakeConfiguration:function(){return C},prepareHandshakeDetails:function(){return M},serializeMessageData:function(){return D},serializeMessages:function(){return B},stringToArrayBuffer:function(){return T},transformMessage:function(){return O}});var a=s(5142),n=s(37),i=s.n(n),r=s(2368),o=s.n(r),l=s(1297),c=s(2104),d=s(12245),p=s(2386),u=s(12246),h=s(1888),m=s(40);const E=1e3,g={caps:"upper",format:"twos"},S=1048576,y="sec-websocket-protocol";function _(e,t=!0){return new l.HeaderList({},e).toObject(!0,t)}function T(e,t){const{constructor:s,multiple:a}=u.TYPED_ARRAY_CONSTRUCTOR_MAP[t],n=new ArrayBuffer(e.length*a),i=new s(n);for(let t=0,s=e.length;t<s;t++)i[t]=e.charCodeAt(t);return n}function f(e){let t="";for(let s=0,a=e.length;s<a;s++)t+=String.fromCharCode(e[s]);return t}function b(e){const t=m.reduce(u.WS_CONNECTION_CONFIG,((e,t)=>(e[t.id]=t.defaultValue,e)),{}),s=m.assign({},t,e);return s.maxPayload*=S,s}function v(e){const t=m.keys(e);for(let s=t.length-1;s>=0;s--)if(m.toLower(t[s])===y)return e[t[s]]}async function C(e){const t=function(e){return _(m.map(e,(e=>({key:e.key,value:e.value,disabled:!1===e.enabled}))))}(e.headers);return(0,d.resolveWSRequest)({url:e.url,protocols:v(t),headers:t,options:b(e.settings)})}function M(e,t){const s={};return e&&!m.isNil(e.href)&&(s["Request URL"]=e.href),e&&!m.isNil(e.method)&&(s["Request Method"]=e.method),t&&!m.isNil(t.statusCode)&&(s["Status Code"]=`${t.statusCode} ${t.statusMessage}`),e&&!m.isNil(e.headers)&&(s["Request Headers"]=_(e.headers)),t&&!m.isNil(t.headers)&&(s["Response Headers"]=_(t.headers)),m.isEmpty(s)?null:s}function O(e,t,s){let n,i;return u.WEBSOCKET_MESSAGE_VIEWER_MAP[u.IFRAME].has(m.toLower(m.split(t,"/")[0]))?(i=u.IFRAME,n=e):u.WEBSOCKET_MESSAGE_VIEWER_MAP[u.EDITOR].has(t)?(i=u.EDITOR,n=s?(0,a.hexy)(e,g):e):(i=u.EDITOR,e instanceof ArrayBuffer&&(e=new Uint8Array(e)),n=s?(0,a.hexy)(Array.from(e),g):String.fromCharCode.apply(null,e)),{message:n,viewer:i}}function A(e,{message:t,mimeType:s,url:a}={}){switch(e){case u.WEBSOCKET_CONNECTED_MESSAGE:return`Connected to ${a}`;case u.WEBSOCKET_DISCONNECTED_MESSAGE:return`Disconnected from ${a}`;case u.WEBSOCKET_RECONNECTING_MESSAGE:return`Reconnecting to ${a}`;case u.WEBSOCKET_ABORT_MESSAGE:return"Connection aborted";case u.WEBSOCKET_ERROR_MESSAGE:return`Could not connect to ${a}`;case u.WEBSOCKET_INCOMING_MESSAGE:case u.WEBSOCKET_OUTGOING_MESSAGE:{if(m.isNil(t)&&m.isNil(s)||!t)return{text:"(empty)",placeholder:!0};const e=m.toLower(m.split(s,"/")[0]);return u.WEBSOCKET_MESSAGE_SUPPORTED_MEDIA_TYPES.has(e)?{text:m.startCase(e),placeholder:!0,truncated:!1}:m.isString(t)&&u.WEBSOCKET_MESSAGE_READABLE.has(s)?{text:t.substring(0,u.MESSAGE_PREVIEW_TRUNCATE_THRESHOLD),placeholder:!1,truncated:t.length>u.MESSAGE_PREVIEW_TRUNCATE_THRESHOLD}:{text:"Binary",placeholder:!0,truncated:!1}}default:return""}}function N(e,t){if(!e)return null;const s=u.WEBSOCKET_CONNECTION_CLOSE_CODES[e];return s?{code:e,name:s.name,description:t||s.description}:u.WEBSOCKET_CONNECTION_CLOSE_CODES.unknown(e,t)}function w(e,t,s){if(!e)throw new Error("WebSocketRequestHelper~createMessage: Cannot create message without type");const a={id:i()(),type:e};return s&&(a.meta=s),t&&(a.payload=t),a}function I(e){return e===E}function k(e){if(!(0,p.isLoggedIn)())return(0,p.isWorkspaceMember)()&&m.isEmpty(e)?{isDisabled:!0,reason:u.DISABLED_TOOLTIP_TEXT.emptyURL}:{isDisabled:!1};let t;const s=o().valid(o().coerce(pm.runtime.version)),a=(0,c.getStore)("PermissionStore").can("addHistory","workspace",(0,c.getStore)("ActiveWorkspaceStore").id),n=(0,p.isWorkspaceMember)()&&a,i=(0,p.canJoinWorkspace)(),r=Boolean(!n||m.isEmpty(e)&&(t=u.DISABLED_TOOLTIP_TEXT.emptyURL)||"browser"===window.SDK_PLATFORM&&(m.get(pm.runtime.agent,"stat.type")!==h.TYPES.WS&&(t=u.DISABLED_TOOLTIP_TEXT.nonWsAgent)||!pm.runtime.agent.isReady&&(t=u.DISABLED_TOOLTIP_TEXT.agentNotConnected)||s&&o().lt(s,u.WS_REQUEST_ENABLED_DESKTOP_AGENT_VERSION)&&(t=u.DISABLED_TOOLTIP_TEXT.oldAgent)));return t||(!n&&i?t=u.DISABLED_TOOLTIP_TEXT.notMember:n||i||(t=u.DISABLED_TOOLTIP_TEXT.noPermission)),{isDisabled:r,reason:t}}function R(){return[{value:"Connection"},{value:"Cookie"},{value:"Host"},{value:"Origin"},{value:"Sec-WebSocket-Extensions"},{value:"Sec-WebSocket-Key"},{value:"Sec-WebSocket-Origin"},{value:"Sec-WebSocket-Protocol"},{value:"Sec-WebSocket-Version"},{value:"Upgrade"},{value:"User-Agent"}]}function P(e){return{url:(e=m.cloneDeep(e)).url,headers:e.headers||[],queryParams:e.queryParams||[],settings:e.settings||{},createdAt:(new Date).toISOString()}}function D(e){let t=e&&e.constructor.name;if(!t)return{payload:"",type:"String"};const s={type:t};switch(t){case"Uint8Array":e=f(e);break;case"Object":e=JSON.stringify(e);break;default:e=String(e),t="String"}return s.payload=e,s}function B(e){const t=[];return e.forEach((e=>{t.push({id:e.id,type:e.type,data:D(e.payload,e.type,m.get(e.meta,"preview")),meta:m.omit(e.meta,["preview"])})})),t}function W({payload:e,type:t}={}){if(t)switch(t){case"Uint8Array":return new Uint8Array(T(e,"Uint8Array"));case"Object":return JSON.parse(e);default:return String(e)}}function L(e,t){const s=new Map;return m.isEmpty(t)||t.forEach((t=>{let a="";try{a=W(t.data)}catch(e){pm.logger.error("WebSocketRequestHelper~deserializeMessages",e)}const n=t.id;s.set(n,{id:n,type:t.type,meta:m.assign(t.meta,{preview:t.data.preview||A(t.type,{message:a,mimeType:t.meta.mimeType,url:e})}),payload:a})})),s}function x(e){var t;const s={timestamp:e.meta.time,payload:{}};return s.payload={data:D(e.payload),...e.meta.mimeType?{mimeType:e.meta.mimeType}:{},size:(null===(t=e.meta)||void 0===t?void 0:t.size)||0,...e.meta.fileExtension?{fileExtension:e.meta.fileExtension}:{},...e.meta.eventName?{eventName:e.meta.eventName}:{}},s}function G(e,{url:t},s){try{const a=W(e.payload.data),n=A(s,{message:a,url:t,mimeType:e.payload.mimeType});return{type:s,meta:{time:e.timestamp,mimeType:e.payload.mimeType,size:e.payload.size,eventName:e.payload.eventName,fileExtension:e.payload.fileExtension,preview:n},payload:a}}catch(e){pm.logger.error("WebSocketRequestHelper~parseSentOrReceviedMessageEvent~deserializeMessages",e)}}},12242:function(e,t,s){s.r(t),s.d(t,{RawComposeMessage:function(){return o},SocketIOComposeMessage:function(){return l},WebSocketComposeMessage:function(){return r}});var a=s(37),n=s.n(a),i=s(5464);class r{constructor({content:e="",type:t=i.WebSocketMessageBodyType.TEXT,subtype:s=null}={}){this.content=String(e),this.type=String(t),this.subtype=null===s?s:String(s)}}class o extends r{constructor({id:e=n()(),title:t="New message",...s}={}){super(s),this.id=String(e),this.title=String(t)}}class l{constructor({id:e=n()(),title:t="New message",eventName:s="",acknowledgement:a=!1,args:i=[]}={}){this.id=String(e),this.title=String(t),this.eventName=String(s),this.acknowledgement=Boolean(a),this.args=Array.from(i).map((e=>new r(e))),this.args.length||this.args.push(new r)}}},12240:function(e,t,s){s.r(t),s.d(t,{BaseEventParser:function(){return h},BaseMessageParser:function(){return m},EVENT_TO_MESSAGE_TYPE_MAP:function(){return l},MESSAGE_TO_EVENT_TYPE_MAP:function(){return o}});var a=s(5508),n=s(5463),i=s(5507),r=s(40);const o={[n.WEBSOCKET_CONNECTED_MESSAGE]:"connected",[n.WEBSOCKET_DISCONNECTED_MESSAGE]:"disconnected",[n.WEBSOCKET_ERROR_MESSAGE]:"error",[n.WEBSOCKET_RECONNECTING_MESSAGE]:"reconnecting",[n.WEBSOCKET_ABORT_MESSAGE]:"aborted",[n.WEBSOCKET_OUTGOING_MESSAGE]:"sent-message",[n.WEBSOCKET_INCOMING_MESSAGE]:"received-message"},l=r.reduce(o,((e,t,s)=>(e[t]=s,e)),{}),c=e=>Object.entries(e).map((([e,t])=>({key:e,value:t}))),d=e=>null==e?void 0:e.reduce(((e,{key:t,value:s})=>({...e,[t]:s})),{}),p=e=>{const{handshakeRequest:t,handshakeResponse:s}=e,a=null==t?void 0:t.url,n=null==t?void 0:t.method,i=null==s?void 0:s.statusCode,r=null==s?void 0:s.statusMessage,o=d(null==t?void 0:t.headers),l=d(null==s?void 0:s.headers);if(a||n||i||o||l)return{"Request URL":a,"Request Method":n,...i?{"Status Code":`${i} ${r}`}:{},...o?{"Request Headers":o}:{},...l?{"Response Headers":l}:{}}},u=e=>{var t;const s=null==e||null===(t=e.payload)||void 0===t?void 0:t.handshakeDetails;let a="",n=null;if(null!=s&&s["Status Code"]){const e=s["Status Code"].split(" ");n=parseInt(e[0],10),a=e.slice(1).join(" ")}return{...s?{handshakeRequest:{method:s["Request Method"],headers:c(s["Request Headers"]),url:s["Request URL"]},...n&&s["Response Headers"]?{handshakeResponse:{statusCode:n,statusMessage:a,headers:c(s["Response Headers"])}}:{}}:{}}},h={connected:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"application/json",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{handshakeDetails:p(e.payload)}}},disconnected:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{code:e.payload.code,name:e.payload.reason,description:(r=e.payload,r.code?(null===(c=n.WEBSOCKET_CONNECTION_CLOSE_CODES[r.code])||void 0===c?void 0:c.description)||n.WEBSOCKET_CONNECTION_CLOSE_CODES.unknown(r.code,"Error"!==r.reason?r.reason:"").description:r.reason&&(null===(o=a.SOCKETIO_CONNECTION_CLOSE_CODES[r.reason.toLowerCase()])||void 0===o?void 0:o.description)||a.SOCKETIO_CONNECTION_CLOSE_CODES.unknown(r.reason).description||"")}};var r,o,c},error:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"application/json",preview:(0,i.getMessagePreview)(s,{url:t})},payload:{error:e.payload.error.message,handshakeDetails:p(e.payload)}}},reconnecting:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})}}},aborted:(e,t)=>{const s=l[e.type];return{type:s,meta:{time:e.timestamp,mimeType:"text/plain",preview:(0,i.getMessagePreview)(s,{url:t})}}}},m={[n.WEBSOCKET_CONNECTED_MESSAGE]:e=>{const t={type:o[e.type],timestamp:e.meta.time,payload:{}};return t.payload=u(e),t},[n.WEBSOCKET_DISCONNECTED_MESSAGE]:(e,t)=>{var s;const a={type:o[e.type],timestamp:e.meta.time,payload:{}},i=e.payload||{};return a.payload={...i.code?{code:i.code}:{},reason:i.name},1e3===i.code?t.result="success":[1002,1003,1005,1006,1007,1008,1009,1010].includes(i.code)?t.result="client-error":[1001,1011,1012,1013,1014,1015].includes(i.code)&&(t.result="server-error"),t.summary=(null===(s=n.WEBSOCKET_CONNECTION_CLOSE_CODES[i.code])||void 0===s?void 0:s.name)||"Error",a},[n.WEBSOCKET_ERROR_MESSAGE]:(e,t)=>{var s;const a={type:o[e.type],timestamp:e.meta.time,payload:{}},n=null==e||null===(s=e.payload)||void 0===s?void 0:s.error;return a.payload={...n?{error:{message:n}}:{},...u(e)},n&&(t.result="client-error",t.summary=n),a},[n.WEBSOCKET_RECONNECTING_MESSAGE]:e=>({type:o[e.type],timestamp:e.meta.time,payload:{}}),[n.WEBSOCKET_ABORT_MESSAGE]:(e,t)=>{const s={type:o[e.type],timestamp:e.meta.time,payload:{}};return t.summary="aborted",s}}},12238:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var a,n,i,r=s(1039),o=s(4596),l=s(4601),c=s(4600),d=s(12239),p=s(12241),u=s(12243),h=s(5463),m=s(5501),E=s(40);function g(e,t,s,a){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(a):void 0})}function S(e,t,s,a,n){var i={};return Object.keys(a).forEach((function(e){i[e]=a[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,a){return a(e,t,s)||s}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}let y=(a=class extends c.default{constructor(...e){super(...e),this.id=null,g(this,"model",n,this),this._models=new Map([]),g(this,"status",i,this)}setWorkbenchStatus(e){this.status=e,e!==o.READY&&e!==o.ERROR||this.setLoading(!1)}setActiveModel(e,...t){if(e!==E.get(this.model,"type")){if(this._models.has(e))return this.model=this._models.get(e),void this.attachTrackedState();switch(E.isEmpty(t)&&(t=[{id:this.id||this.wsHistoryId},h.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,{tabId:this.getTabId()}]),e){case h.WEBSOCKET_REQUEST_TYPE.RAW:this._models.set(h.WEBSOCKET_REQUEST_TYPE.RAW,new u.default(...t));break;case h.WEBSOCKET_REQUEST_TYPE.SOCKETIO:this._models.set(h.WEBSOCKET_REQUEST_TYPE.SOCKETIO,new p.default(...t));break;default:this._models.set("default",new d.default(...t))}this.model=this._models.get(e),this.setConflictOptions({entityType:"WebSocket request"}),this.attachTrackedState(),this.nameReactionDisposer=(0,r.reaction)((()=>this.model.name),(e=>this.setTitle(e)),{fireImmediately:!0})}}setConflictStatus(){this.setStatus("Conflict","This WebSocket request has been modified since you last opened the tab.")}attachTrackedState(){return this.model?this.model._trackedRequest?"function"!=typeof this.model.save?pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: save is not a function"):(super.detachTrackedState(),void super.attachTrackedState(this.model._trackedRequest,this.model.save.bind(this.model),{persist:!0})):pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: _trackedRequest not found"):pm.logger.error("BaseWebSocketWorkbenchController~attachTrackedState: model not found")}restoreRequestState(){if(!this.model)return;const e=this.getPersistedTrackedState();if(!e||!e.isDirty){var t;const e=(0,m.getData)(null===(t=this.model)||void 0===t?void 0:t.type,this.getTabId());return E.isEmpty(e)?void 0:this.model._trackedRequest.set(e)}this.model._trackedRequest.set((0,r.toJS)(e.updates)),(0,l.detectConflict)(this.model.initialState,e.initialState,this.model.isDirty,(t=>{t&&(this.model._trackedRequest.setInitialState((0,r.toJS)(e.initialState)),this.setConflictStatus())}))}didCreate(){}beforeDestroy(){this._models.forEach((e=>{e.nameReactionDisposer&&e.nameReactionDisposer(),e.dispose&&e.dispose()})),this.model&&this.model.disconnect(!0),this._models=null}},n=S(a.prototype,"model",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),i=S(a.prototype,"status",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return o.LOADING}}),S(a.prototype,"setWorkbenchStatus",[r.action],Object.getOwnPropertyDescriptor(a.prototype,"setWorkbenchStatus"),a.prototype),S(a.prototype,"setActiveModel",[r.action],Object.getOwnPropertyDescriptor(a.prototype,"setActiveModel"),a.prototype),a)},12239:function(e,t,s){s.r(t),s.d(t,{default:function(){return se}});var a,n,i,r,o,l,c,d,p,u,h,m,E,g,S,y,_,T,f,b,v,C,M,O,A,N=s(37),w=s.n(N),I=s(5136),k=s(5391),R=s.n(k),P=s(1039),D=s(2108),B=s(5086),W=s(4470),L=s(6445),x=s(2218),G=s(1888),U=s(2219),K=s(5098),H=s(5080),F=s(5097),q=s(5096),Y=s(4225),z=s(2082),V=s(5583),j=s(4503),Q=s(5501),J=s(5463),$=s(12240),X=s(40);function Z(e,t,s,a){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(a):void 0})}function ee(e,t,s,a,n){var i={};return Object.keys(a).forEach((function(e){i[e]=a[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,a){return a(e,t,s)||s}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function te(e){return e?X.map([...e.values()],(e=>e.id)):[]}let se=((A=class{constructor(e,t,s=J.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,a={}){if(this.id=null,this.type="default",this.requestInfo={},Z(this,"title",n,this),Z(this,"collection",i,this),Z(this,"messageMap",r,this),this.connectionId=null,this.connectionHistoryId=null,this.handshakeConfiguration=null,this.handshakeError=!1,Z(this,"status",o,this),Z(this,"badgeStatus",l,this),Z(this,"connectionStatistics",c,this),Z(this,"activeConnectionTab",d,this),Z(this,"messageTypeFilter",p,this),Z(this,"messageFilter",u,this),Z(this,"expandedMessageSet",h,this),Z(this,"selectedMessageSet",m,this),Z(this,"firstVisibleMessageIndex",E,this),Z(this,"context",g,this),Z(this,"messageMediaFilePaths",S,this),Z(this,"messageStreamNotificationType",y,this),Z(this,"messageStreamStatus",_,this),this.historyEventToMessageType=$.EVENT_TO_MESSAGE_TYPE_MAP,this.messageToHistoryEventType=$.MESSAGE_TO_EVENT_TYPE_MAP,this.messageParser=$.BaseMessageParser,this.historyEventParser=$.BaseEventParser,Z(this,"messages",T,this),Z(this,"newMessages",f,this),this.scrollOffset=0,this._messageBuffer=[],Z(this,"savedMessages",b,this),Z(this,"draftComposeMessage",v,this),Z(this,"currentComposeMessage",C,this),Z(this,"editTitle",M,this),Z(this,"savedMessagesStatus",O,this),this.pendingPromiseMap={},!t)throw new Error(`${this.constructor.name}~constructor: request was not found`);this.id=t.id,this.type=e||t.type||this.type,this.title=t.title,this.collection=t.collection,this.requestInfo={createdAt:t.createdAt},this.set("context",a),this._trackedRequest=new j.ObservableTrackedState(this.getRequestForView(t)),this.set("messageMap",t.messageMap||P.observable.map()),this.set("messages",te(t.messageMap)),this.set("messageStreamStatus",s),this.draftComposeMessage=new j.ObservableTrackedState(new this.constructor.MessageClass),this.currentComposeMessage=this.draftComposeMessage,X.get(a,"isHistory")&&this.set("badgeStatus",J.IDLE),this.requestSDK=J.SDK_MAP[this.type],this.messageSDK=J.SDK_MAP[J.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]],this.fetchSavedMessage(),this.attachConnectionEventsListener(),this.agentConnectionAutorunDisposer=(0,P.autorun)((()=>{const{type:e,state:t}=pm.runtime.agent.stat;!this.connectionId||e===G.TYPES.WS&&t===G.STATES.CONNECTED||this.disconnect(!0)})),this.connectionStatusReactionDisposer=(0,P.reaction)((()=>this.status),(e=>{if(e===J.CONNECTED||e===J.IDLE)return this.showIntermediateStatusTimeout&&clearTimeout(this.showIntermediateStatusTimeout),void this.set("badgeStatus",e);this.showIntermediateStatusTimeout&&clearTimeout(this.showIntermediateStatusTimeout),this.showIntermediateStatusTimeout=setTimeout((()=>this.set("badgeStatus",e)),100)})),(0,P.reaction)((()=>this.hasUnsavedMessages),(e=>{this.set("_hasUnsavedMessages",e)}),{fireImmediately:!0}),(0,P.reaction)((()=>this.hasUnsavedDraft),(e=>{this.set("_hasUnsavedDraft",e)}),{fireImmediately:!0})}set(e,t){this[e]=t}set message(e){const t=e.id;this.messageMap.set(t,e),this._messageBuffer.push(t),this._interval||(this._interval=setTimeout((0,P.action)((()=>{0===this.scrollOffset?this.messages.push(...this._messageBuffer):this.newMessages.push(...this._messageBuffer),this._interval=null,this._messageBuffer=[]})),100))}get isDirty(){return this._trackedRequest.isDirty}get initialState(){return this._trackedRequest.initialState}get updates(){return this._trackedRequest.updates}set url(e){this._trackedRequest.set({url:e})}get url(){return this._trackedRequest.get("url")}set headers(e){this._trackedRequest.set({headers:e})}get headers(){return this._trackedRequest.get("headers")}set queryParams(e){this._trackedRequest.set({queryParams:e})}get queryParams(){return this._trackedRequest.get("queryParams")}set settings(e){this._trackedRequest.set({settings:e})}get settings(){return this._trackedRequest.get("settings")}set _hasUnsavedMessages(e){this._trackedRequest.set({_hasUnsavedMessages:e})}set _hasUnsavedDraft(e){this._trackedRequest.set({_hasUnsavedDraft:e})}get hasMultipleSavedMessages(){var e,t,s;return(null===(e=K.default.cacheAPI.get(this.id))||void 0===e||null===(t=e.children)||void 0===t||null===(s=t.filter((e=>e.type===J.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type])))||void 0===s?void 0:s.length)>1}get layoutName(){return(0,W.resolveStoreInstance)(L.default).get("editor.requestEditorLayoutName")}get extensions(){return this._trackedRequest.get("extensions")}resetTracking(){const e=X.reduce(this.constructor.editableAttributes,((e,t,s)=>(X.has(this,s)?e[s]=this[s]:e[s]=t.defaultsTo,e)),{});e._hasUnsavedMessages=!1,e._hasUnsavedDraft=!1,this._trackedRequest.reset(e)}get visibleMessages(){const e=X.slice(this.messages,this.firstVisibleMessageIndex);return X.map(e,(e=>this.messageMap.get(e)))}get filteredMessagesByType(){if(this.messageTypeFilter===J.WEBSOCKET_ALL_MESSAGES)return this.visibleMessages;return new I.default(this.visibleMessages,this.constructor.keysForFilterByType).search(this.messageTypeFilter)}get filteredMessages(){if(!this.messageFilter)return this.filteredMessagesByType;return new I.default(this.filteredMessagesByType,this.constructor.keysForFilterByKeyword).search(this.messageFilter)}get visibleItems(){return!this.isFilterApplied&&this.hasMessagesToRestore?[{type:J.WEBSOCKET_HIDDEN_MESSAGE},...this.filteredMessages]:this.filteredMessages}get hasMessagesToRestore(){return 0!==this.firstVisibleMessageIndex}get isFilterApplied(){return this.messageFilter||this.messageTypeFilter!==J.WEBSOCKET_ALL_MESSAGES}flushNewMessages(){this.messages=X.concat(this.messages,this.newMessages),this.newMessages.clear()}hideAllMessages(){this.firstVisibleMessageIndex+=this.visibleMessages.length}clearAllMessages(){(0,P.transaction)((()=>{this.firstVisibleMessageIndex=0,this.messageMap.clear(),this.messages.clear(),this.newMessages.clear()}))}restoreHiddenMessages(){this.firstVisibleMessageIndex=0}toggleExpanded(e,t){return this.expandedMessageSet.has(e)?X.isNil(t)?this.expandedMessageSet.delete(e):void this.expandedMessageSet.set(e,t):this.expandedMessageSet.set(e,{})}toggleMessageSelect(e){this.selectedMessageSet.has(e)?this.selectedMessageSet.delete(e):this.selectedMessageSet.set(e,!0)}deselectAllMessages(){this.selectedMessageSet.clear()}saveMediaFilePath(e,t){e&&this.messageMediaFilePaths.set(e,t)}get timeDifference(){const e=[...this.selectedMessageSet.keys()],t=X.get(this.messageMap.get(e[0]),"meta.time"),s=X.get(this.messageMap.get(e[1]),"meta.time");return t&&s?R()(Math.abs(new Date(t).getTime()-new Date(s).getTime())):"Not available"}async createNewMessage(e){const t=new j.ObservableTrackedState(new this.constructor.MessageClass(e));await this.saveMessage(t,!0)}async saveMessage(e,t=!1){const s={...(0,P.toJS)(e.initialState),...(0,P.toJS)(e.updates)};if(void 0!==s.eventName&&(""===s.eventName&&(s.eventName="message"),this.eventsCache.getColor(s.eventName)),!t){if(!this.messageSDK.isOnline(!0)||!this.messageSDK.hasPermission(s.id,H.ItemAction.SAVE,!0))throw new Error(`${this.constructor.saveMessage}~saveMessage: Cannot execute this action.`);try{return await this.messageSDK.update(this._serializeSavedMessage(s)),void e.reset(s)}catch(e){throw pm.logger.error(`${this.constructor.name}~saveMessage: Error in updating message`,e),pm.toasts.error("Something went wrong while saving the message.",{dedupeId:"ws-message-save"}),e}}if(!this.messageSDK.isOnline(!0)||!this.messageSDK.hasPermission(null,H.ItemAction.CREATE,!0,this.id))throw new Error(`${this.constructor.saveMessage}~saveMessage: Cannot execute this action.`);try{this._selfMessageCreate=!0,await this.messageSDK.create(this.id,this._serializeSavedMessage(X.omit(s,"id"))),e.resetUpdates()}catch(e){throw pm.logger.error(`${this.constructor.name}~saveAsMessage: Error in creating message`,e),pm.toasts.error("Something went wrong while saving the message.",{dedupeId:"ws-message-create"}),e}}async deleteSavedMessage(e){if(this.draftComposeMessage===e)return e.resetUpdates();this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(e.get("id"),H.ItemAction.DELETE,!0)&&pm.mediator.trigger("showDeleteWebSocketMessageModal",e.get("title"),(async()=>{try{await this.messageSDK.delete(e.get("id"));const t=this.savedMessages.indexOf(e);-1!==t&&(0,P.runInAction)((()=>this.savedMessages.splice(t,1))),this.currentComposeMessage===e&&(0,P.runInAction)((()=>{this.currentComposeMessage=this.draftComposeMessage}))}catch(e){pm.logger.error(`${this.constructor.name}~deleteSavedMessage: Error in deleting message`,e),pm.toasts.error("Something went wrong while deleting the message.",{dedupeId:"ws-message-delete"})}}))}async duplicateSavedMessage(e){const t=X.omit((0,P.toJS)(e.initialState),"id");if(this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(e.get("id"),H.ItemAction.DUPLICATE,!0))try{this._selfMessageCreate=!0,await this.messageSDK.create(this.id,this._serializeSavedMessage(t))}catch(e){pm.logger.error(`${this.constructor.name}~duplicateSavedMessage: Error in creating message`,e),pm.toasts.error("Something went wrong while duplicating the message.",{dedupeId:"ws-message-dup"})}}revertSavedMessage(e){e.resetUpdates()}selectSavedMessage(e){this.currentComposeMessage=e}async saveMessageProperty(e,t,s){const a={...(0,P.toJS)(e.initialState),[t]:s};if(e.get("id")===this.draftComposeMessage.get("id"))return e.set({[t]:s});if(this.messageSDK.isOnline(!0)&&this.messageSDK.hasPermission(a.id,H.ItemAction.SAVE,!0))try{await this.messageSDK.update(this._serializeSavedMessage(a)),e.set({[t]:s}),e.setInitialState(a)}catch(e){pm.logger.error(`${this.constructor.name}~saveMessageProperty: Error in updating message property.`,e),pm.toasts.error("Something went wrong while updating the message.",{dedupeId:"ws-message-save"})}}toggleSavedMessagePane(e){this.savedMessagesPaneRef&&this.savedMessagesPaneRef.handleCollapseToggle("x",e)}_serializeSavedMessage(){throw new Error(`${this.constructor.name}~_serializeSavedMessage: not implemented`)}_deserializeSavedMessage(){throw new Error(`${this.constructor.name}~_deserializeSavedMessage: not implemented`)}async fetchSavedMessage(){const{children:e}=K.default.cacheAPI.get(this.id)||{};if(this.isSavedRequest&&!this.messagesChangeListenersDisposer&&(this.messagesChangeListenersDisposer=K.default.cacheAPI.subscribeToChanges({onCreate:e=>this.handleIncomingMessages("onCreate",e),onUpdate:e=>this.handleIncomingMessages("onUpdate",e),onDelete:e=>this.handleIncomingMessages("onDelete",e)},{parent:this.id,type:J.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]})),this.isSavedRequest&&!X.isEmpty(e)){this.set("savedMessagesStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading);try{const e=[J.REQUEST_TYPE_TO_MESSAGE_TYPE_MAP[this.type]],t=await this.requestSDK.getAllChildrenObservable(this.id,e),{MessageClass:s}=this.constructor;(0,P.transaction)((()=>{(0,P.runInAction)((()=>this.savedMessages.push(...(t||[]).map((e=>new j.ObservableTrackedState(new s(this._deserializeSavedMessage(e)))))))),this.set("savedMessagesStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)})),this.selectSavedMessage(this.savedMessages[0])}catch(e){this.set("savedMessagesStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Error),pm.logger.error(`${this.constructor.name}~didCreate: Error in loading messages`,e)}}else this.set("savedMessagesStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}handleIncomingMessages(e,t){const{MessageClass:s}=this.constructor;switch(e){case"onCreate":return void this.messageSDK.getObservable(t.id).then((e=>{const t=new j.ObservableTrackedState(new s(this._deserializeSavedMessage(e)));(0,P.runInAction)((()=>{this.savedMessages.push(t),this._selfMessageCreate&&(this.currentComposeMessage=t,this._selfMessageCreate=!1,this.savedMessages.length>1&&(this.editTitle=t.get("id"),this.toggleSavedMessagePane(!1)))}))})).catch((e=>pm.logger.error(`${this.constructor.name}~handleIncomingMessages: Error in fetching new message`,e)));case"onUpdate":{const e=X.find(this.savedMessages,(e=>e.get("id")===t.id));return void(e&&e.setInitialState(new s(this._deserializeSavedMessage(t))))}case"onDelete":{const e=X.findIndex(this.savedMessages,(e=>e.get("id")===t.id));if(-1===e)return;return this.currentComposeMessage===this.savedMessages[e]&&(this.currentComposeMessage=this.draftComposeMessage),this.savedMessages.splice(e,1)}}}get name(){return this.title||this.url||"Untitled Request"}get breadcrumbPath(){const e=K.default.cacheAPI.get(this.id);if(!e)return;const t=[];let s=e;for(;s;)t.push({id:s.id,type:s.type,name:s.title}),s=s.parent&&(K.default.cacheAPI.get(s.parent)||F.default.cacheAPI.get(s.parent));return X.reverse(t)}get connectionConfigEditDisabled(){return this.status===J.CONNECTING||this.status===J.RECONNECTING||this.status===J.CONNECTED}get isSavedRequest(){return Boolean(this.collection)}get hasUnsavedMessages(){return X.some(this.savedMessages,"isDirty")}get hasUnsavedDraft(){return X.isEmpty(this.savedMessages)&&this.currentComposeMessage.isDirty}get actions(){return[{type:H.ItemAction.DELETE,label:"Delete",shortcut:"delete",isEnabled:this.requestSDK.isOnline()&&this.requestSDK.hasPermission(this.id,H.ItemAction.DELETE)}]}unsetContext(e){this.context&&delete this.context[e]}connectionSetup(){this.connectionId=w()(),this.handshakeError=!1,(0,P.transaction)((()=>{this.clearAllMessages(),this.deselectAllMessages(),this.set("connectionStatistics",{}),this.expandedMessageSet.clear(),this.messageMediaFilePaths.clear(),this.set("messageStreamStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}))}connectionCleanup(){this.connectionId=null,this.connectionHistoryId=null,this.handshakeConfiguration=null}getRequestForView(e){const t=X.get(e,"payload",{}),s=X.reduce(this.constructor.editableAttributes,((e,s,a)=>(X.has(t,a)?e[a]=t[a]:e[a]=s.defaultsTo,e)),{});return s.headers=(0,Y.mapDisableToEnable)(s.headers),s.queryParams=(0,Y.mapDisableToEnable)(s.queryParams),s.extensions=X.get(e,"extensions",{documentation:{content:""}}),s._hasUnsavedMessages=!1,s._hasUnsavedDraft=!1,s}getRequestForStorage(){const e=(0,P.toJS)({id:this.id,type:this.type,title:this.title,payload:{url:this.url,headers:this.headers,queryParams:this.queryParams,settings:this.settings}},{recurseEverything:!0});return e.payload.headers=(0,Y.mapEnableToDisable)(e.payload.headers),e.payload.queryParams=(0,Y.mapEnableToDisable)(e.payload.queryParams),e}handleIncomingUpdates(e){e&&(0,P.transaction)((()=>{this.set("title",e.title),this._trackedRequest.setInitialState(this.getRequestForView(e))}))}cacheUpdatesBuffer(){(0,Q.setData)(this.type,X.get(this.context,"tabId"),(0,P.toJS)(this._trackedRequest.updates))}attachConnectionEventsListener(){}requestWorkbenchSave(){U.default.requestSave({id:(0,W.resolveStoreInstance)(x.default).activeEditor})}saveAs(){if(z.default.isEnabled)return pm.mediator.trigger("showSignInModal",{type:"save",origin:"save_shortcut",subtitle:V.SAVE_REQUEST_SIGNIN_MODAL_SUBTITLE});if(!((0,W.resolveStoreInstance)(B.default).userCanSave&&(!X.isEmpty(F.default.getEditableCollections())||F.default.hasPermission(null,q.ECAction.CREATE,!0))))return;let e;if(this.hasUnsavedDraft){const t={...(0,P.toJS)(this.currentComposeMessage.initialState),...(0,P.toJS)(this.currentComposeMessage.updates)};e=this._serializeSavedMessage(X.omit(t,"id"))}pm.mediator.trigger("showAddItemToCollectionModal",X.omit(this.getRequestForStorage(),"id"),{tabId:X.get(this.context,"tabId")},(async t=>{e&&await this.messageSDK.create(t,e)}))}save({saveAs:e}){if(!this.id)return pm.logger.error(`${this.constructor.name}~save: Request id not found`),Promise.reject(new Error("Request id not found"));if(e||!this.isSavedRequest)return this.saveAs(),Promise.resolve();if(!((this.isDirty||!this.isSavedRequest)&&this.requestSDK.isOnline(!0)&&this.requestSDK.hasPermission(this.id,H.ItemAction.SAVE,!0)))return Promise.resolve();const t=[];return this.hasUnsavedMessages&&X.forEach(this.savedMessages,(e=>{e.isDirty&&t.push(this.saveMessage(e))})),this.hasUnsavedDraft&&t.push(this.saveMessage(this.currentComposeMessage,!0)),Promise.all([this.requestSDK.update(this.getRequestForStorage()).catch((e=>(pm.logger.error("Error while updating WebSocket request",e),pm.toasts.error("Something went wrong while saving the request.",{dedupeId:"ws-request-tab-save"}),Promise.reject(new Error("Error while updating request."))))),...t]).then((()=>this.resetTracking()))}_getHistoryMeta(){return{url:(0,P.toJS)(this.url),headers:(0,P.toJS)(this.headers),queryParams:(0,P.toJS)(this.queryParams),settings:(0,P.toJS)(this.settings),subprotocol:J.WEBSOCKET_REQUEST_TYPE_TO_SUBPROTOCOL_MAP[this.type],createdAt:(new Date).toISOString()}}_getHistoryContext(){const e=this.getRequestForStorage();return{workspaceId:(0,W.resolveStoreInstance)(D.default).id,url:(0,P.toJS)(this.url),collectionId:this.collection,item:{...e,id:this.collection?this.id:null,title:this.title||"Untitled WebSocket Request",extensions:(0,P.toJS)(this.extensions)}}}_messagesToHistoryEvents(){const e=[],t={result:"success",summary:"Normal Closure"};return this.messageMap.forEach((s=>{const a=this.messageToHistoryEventType[s.type];a&&e.push({type:a,...this.messageParser[s.type](s,t)})})),e.push(t),e}_historyEventsToMessages(e){const t=new Map,s=this.getRequestForStorage();return X.forEach(e,(e=>{const a=w()(),n=this.historyEventToMessageType[e.type];n&&t.set(a,{id:a,...this.historyEventParser[e.type](e,s.payload.url,n)})})),t}_serializeMessages(e){return[]}_deserializeMessages(e){return new Map}onMessageStreamFetch(e,t){if(e)return this.set("messageStreamStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Error);if(t.find((e=>void 0===e.payload)))return this.set("messageStreamStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Truncated);const s=this._historyEventsToMessages(t);this.set("messageMap",s),this.set("messages",te(this.messageMap)),0===X.size(this.messageMap)?this.set("messageStreamStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty):this.set("messageStreamStatus",J.WEBSOCKET_MESSAGE_STREAM_STATUS.Ready)}createHistory(){const e=this._getHistoryContext(),t=this._messagesToHistoryEvents();J.SDK_MAP[this.type].history.createHistory([e,...t]).catch((e=>{pm.logger.error(`${this.constructor.name}~onEnd: Error while creating history`,e)}))}dispose(){this.agentConnectionAutorunDisposer&&this.agentConnectionAutorunDisposer(),this.connectionStatusReactionDisposer&&this.connectionStatusReactionDisposer(),this.messagesChangeListenersDisposer&&this.messagesChangeListenersDisposer(),this.messagesChangeListenersDisposer=null}}).editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}}},n=ee((a=A).prototype,"title",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=ee(a.prototype,"collection",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),r=ee(a.prototype,"messageMap",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.map()}}),o=ee(a.prototype,"status",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return J.IDLE}}),l=ee(a.prototype,"badgeStatus",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=ee(a.prototype,"connectionStatistics",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=ee(a.prototype,"activeConnectionTab",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return J.WEBSOCKET_MESSAGES}}),p=ee(a.prototype,"messageTypeFilter",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return J.WEBSOCKET_ALL_MESSAGES}}),u=ee(a.prototype,"messageFilter",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=ee(a.prototype,"expandedMessageSet",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.map()}}),m=ee(a.prototype,"selectedMessageSet",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.map()}}),E=ee(a.prototype,"firstVisibleMessageIndex",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g=ee(a.prototype,"context",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=ee(a.prototype,"messageMediaFilePaths",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.map()}}),y=ee(a.prototype,"messageStreamNotificationType",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=ee(a.prototype,"messageStreamStatus",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=ee(a.prototype,"messages",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.array()}}),f=ee(a.prototype,"newMessages",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.array()}}),b=ee(a.prototype,"savedMessages",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.observable.array()}}),v=ee(a.prototype,"draftComposeMessage",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=ee(a.prototype,"currentComposeMessage",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=ee(a.prototype,"editTitle",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=ee(a.prototype,"savedMessagesStatus",[P.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee(a.prototype,"set",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"set"),a.prototype),ee(a.prototype,"isDirty",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"isDirty"),a.prototype),ee(a.prototype,"initialState",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"initialState"),a.prototype),ee(a.prototype,"updates",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"updates"),a.prototype),ee(a.prototype,"url",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"url"),a.prototype),ee(a.prototype,"headers",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"headers"),a.prototype),ee(a.prototype,"queryParams",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"queryParams"),a.prototype),ee(a.prototype,"settings",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"settings"),a.prototype),ee(a.prototype,"hasMultipleSavedMessages",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"hasMultipleSavedMessages"),a.prototype),ee(a.prototype,"layoutName",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"layoutName"),a.prototype),ee(a.prototype,"extensions",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"extensions"),a.prototype),ee(a.prototype,"visibleMessages",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"visibleMessages"),a.prototype),ee(a.prototype,"filteredMessagesByType",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"filteredMessagesByType"),a.prototype),ee(a.prototype,"filteredMessages",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"filteredMessages"),a.prototype),ee(a.prototype,"visibleItems",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"visibleItems"),a.prototype),ee(a.prototype,"hasMessagesToRestore",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"hasMessagesToRestore"),a.prototype),ee(a.prototype,"isFilterApplied",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"isFilterApplied"),a.prototype),ee(a.prototype,"flushNewMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"flushNewMessages"),a.prototype),ee(a.prototype,"hideAllMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"hideAllMessages"),a.prototype),ee(a.prototype,"clearAllMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"clearAllMessages"),a.prototype),ee(a.prototype,"restoreHiddenMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"restoreHiddenMessages"),a.prototype),ee(a.prototype,"toggleExpanded",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"toggleExpanded"),a.prototype),ee(a.prototype,"toggleMessageSelect",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"toggleMessageSelect"),a.prototype),ee(a.prototype,"deselectAllMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"deselectAllMessages"),a.prototype),ee(a.prototype,"saveMediaFilePath",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"saveMediaFilePath"),a.prototype),ee(a.prototype,"timeDifference",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"timeDifference"),a.prototype),ee(a.prototype,"createNewMessage",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"createNewMessage"),a.prototype),ee(a.prototype,"selectSavedMessage",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"selectSavedMessage"),a.prototype),ee(a.prototype,"handleIncomingMessages",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"handleIncomingMessages"),a.prototype),ee(a.prototype,"name",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"name"),a.prototype),ee(a.prototype,"breadcrumbPath",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"breadcrumbPath"),a.prototype),ee(a.prototype,"connectionConfigEditDisabled",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"connectionConfigEditDisabled"),a.prototype),ee(a.prototype,"isSavedRequest",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"isSavedRequest"),a.prototype),ee(a.prototype,"hasUnsavedMessages",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"hasUnsavedMessages"),a.prototype),ee(a.prototype,"hasUnsavedDraft",[P.computed],Object.getOwnPropertyDescriptor(a.prototype,"hasUnsavedDraft"),a.prototype),ee(a.prototype,"unsetContext",[P.action],Object.getOwnPropertyDescriptor(a.prototype,"unsetContext"),a.prototype),a)},12237:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var a=s(4596),n=s(2109),i=s(5465),r=s(5504),o=s(12238),l=s(5463);class c extends o.default{didCreate({queryParams:e,additionalContext:t}){var s;const o=this._tabId;this.setWorkbenchStatus(a.LOADING);const c=null===(s=this.getRouteConfig())||void 0===s?void 0:s.routeIdentifier,d=null!=c&&c.includes("ws-socketio-request")?l.WEBSOCKET_REQUEST_TYPE.SOCKETIO:l.WEBSOCKET_REQUEST_TYPE.RAW;if(!e||!e.requestId||e.requestId!==o)return n.default.transitionTo(d===l.WEBSOCKET_REQUEST_TYPE.RAW?i.default.openNewIdentifier:r.default.openNewIdentifier,{},{requestId:o},{tabOptions:{openIn:this._tabId},replace:!0,additionalContext:t});this.id=o,this.setActiveModel(d,{id:this.id},l.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty,{...t,tabId:this.getTabId()}),this.restoreRequestState(),this.setWorkbenchStatus(a.READY)}}},12204:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a,n=s(1),i=s(2399),r=s(4597),o=s(3563),l=s(4596),c=s(12205),d=s(5463);let p=(0,i.observer)(a=class extends n.Component{constructor(){super(),this.handleTypeSwitch=this.handleTypeSwitch.bind(this)}handleTypeSwitch(e){this.props.controller&&this.props.controller.setActiveModel(e)}render(){const{model:e,status:t}=this.props.controller,s=this.props.id;return t===d.WORKBENCH_VIEW_PERMISSION_ERROR?n.createElement(o.default,{userFriendlyEntityName:"WebSocket request",icon:"icon-entity-websocket-stroke",title:"You don't have view permission",message:"Only team members can view WebSocket requests from history of this workspace.",hasToCapitalize:!1}):t===d.WORKBENCH_UNSUPPORTED_SUBPROTOCOL_ERROR?n.createElement(o.default,{type:"error",title:"Unsupported WebSocket request type",message:"Please update your app to view this WebSocket request history.",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===l.ERROR?n.createElement(o.default,{type:"error",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===l.DELETED?n.createElement(o.default,{type:"deleted",userFriendlyEntityName:"WebSocket request",hasToCapitalize:!1}):t===l.READY?n.createElement(c.default,{model:e,editorId:s,switchType:this.handleTypeSwitch}):n.createElement(r.default,null)}})||a},12233:function(e,t,s){s.r(t);var a=s(1),n=s(2399),i=s(2417),r=s(2213),o=s(2405),l=s(2402),c=s(3194),d=s(2429),p=s(2633),u=s(4898),h=s(4363),m=s(12234),E=s(40);const g=(0,i.default)(l.PaneLabel).withConfig({displayName:"WebSocketComposeArea__StyledPaneLabel",componentId:"postman-app__sc-44lva5-0"})([".pane-label__arrow{margin-right:var(--spacing-s) !important;& i > svg > path{fill:var(--content-color-secondary) !important;}}"]),S=(0,i.default)(u.Button).withConfig({displayName:"WebSocketComposeArea__StyledButton",componentId:"postman-app__sc-44lva5-1"})(["padding:var(--spacing-zero) var(--spacing-xs);"]);t.default=(0,n.observer)((({children:e,model:t})=>{const s=a.useRef(null),n=a.useRef(null);function i(){s.current&&s.current.handleCollapseToggle("x")}function y(){n.current&&n.current.unCollapse("x")}return(0,a.useEffect)((()=>{t.hasMultipleSavedMessages&&s.current&&s.current.unCollapse("x")}),[]),(0,a.useEffect)((()=>{1===t.savedMessages.length&&t.savedMessages[0]&&t.savedMessages[0].get("id")!==t.currentComposeMessage.get("id")&&t.selectSavedMessage(t.savedMessages[0])}),[t.savedMessages.length]),(0,a.useEffect)((()=>{s.current&&(s.current.widths.max=t.layoutName===h.REQUESTER_TAB_LAYOUT_1_COLUMN?r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MAX_WIDTH:null)}),[t.layoutName]),t.isSavedRequest?a.createElement(l.PaneGroup,{defaultLayout:o.PANE_LAYOUT_HORIZONTAL},a.createElement(l.Pane,{width:{default:r.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_DEFAULT_WIDTH,min:r.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_MIN_WIDTH,collapsed:r.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_COLLAPSED_WIDTH,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_COMPOSE_PANE_UNCOLLAPSED_WIDTH},ref:e=>{n.current=e}},a.createElement(l.PaneHeader,{defaultLayout:o.PANE_LAYOUT_HORIZONTAL,verticalComponent:a.createElement(l.PaneLabel,{layout:o.PANE_LAYOUT_VERTICAL,label:a.createElement(c.default,{type:"body-medium",color:"content-color-secondary"},"Editor"),arrowDirection:"right",onClick:y})}),a.createElement(l.PaneContent,null,e)),a.createElement(l.Pane,{width:{default:r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_DEFAULT_WIDTH,max:t.layoutName===h.REQUESTER_TAB_LAYOUT_1_COLUMN?r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MAX_WIDTH:null,min:r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_MIN_WIDTH,collapsed:r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_COLLAPSED_WIDTH,uncollapsed:r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_UNCOLLAPSED_WIDTH,collapsedByDefault:!0},ref:e=>{s.current=e,t.savedMessagesPaneRef=e}},a.createElement(l.PaneHeader,{width:r.default.ui.WEBSOCKET_REQUEST_SAVED_MESSAGES_PANE_COLLAPSED_WIDTH,defaultLayout:o.PANE_LAYOUT_HORIZONTAL,horizontalComponent:a.createElement(g,{layout:o.PANE_LAYOUT_HORIZONTAL,label:a.createElement(u.Flex,{alignItems:"center",justifyContent:"space-between"},a.createElement("span",null,"Saved messages"),a.createElement(u.Flex,{alignItems:"center"},a.createElement(S,{icon:a.createElement(d.default,null),variant:"tertiary",onClick:function(){t.hasUnsavedDraft?t.saveMessage(t.currentComposeMessage,!0):t.createNewMessage().catch(E.noop)},size:"small",tooltip:"Add message"}),a.createElement("div",{onClick:i,className:"pane-label__arrow"},a.createElement(p.default,null))))}),verticalComponent:a.createElement(l.PaneLabel,{layout:o.PANE_LAYOUT_VERTICAL,label:a.createElement(u.Flex,{alignItems:"baseline",gap:"spacing-s"},a.createElement(c.default,{type:"body-medium",color:"content-color-secondary"},"Saved messages"),a.createElement(u.DirtyIndicator,{isDirty:!0===t.hasUnsavedMessages||null})),arrowDirection:"left",onClick:i})}),a.createElement(l.PaneContent,null,a.createElement(m.default,{model:t,unCollapseEditorPane:y})))):a.createElement(a.Fragment,null,e)}))},12223:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var a,n=s(1),i=s(2399),r=s(12224),o=s(12225),l=s(12227),c=s(12228),d=s(12229),p=s(12230),u=s(12231),h=s(12232),m=s(12233),E=s(5463);let g=(0,i.observer)(a=class extends n.Component{render(){const{model:e,highlightEventsTab:t}=this.props;return n.createElement(p.default,{activeKey:e.activeConnectionTab},n.createElement(d.default,{key:E.WEBSOCKET_MESSAGES},n.createElement(m.default,{model:e},e.type===E.WEBSOCKET_REQUEST_TYPE.RAW?n.createElement(u.default,{model:e}):n.createElement(h.default,{model:e}))),n.createElement(d.default,{key:E.WEBSOCKET_CONNECTION_QUERY_PARAMS},n.createElement(c.default,{model:e})),n.createElement(d.default,{key:E.WEBSOCKET_CONNECTION_HEADERS},n.createElement(o.default,{model:e})),n.createElement(d.default,{key:E.WEBSOCKET_CONNECTION_SETTINGS},n.createElement(l.default,{model:e})),e.type===E.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&n.createElement(d.default,{key:E.WEBSOCKET_CONNECTION_EVENTS},n.createElement(r.default,{model:e,highlight:t})))}})||a},12222:function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var a,n=s(1),i=s(2399),r=s(4438),o=s(3194),l=s(2635),c=s(2631),d=s(2627),p=s(4363),u=s(2213),h=s(4898),m=s(2417),E=s(4439),g=s(5463),S=s(40);const y=m.default.div.withConfig({displayName:"WebSocketConnectionTabs__IconWrapper",componentId:"postman-app__sc-1mcodaw-0"})(["margin-right:var(--spacing-s);"]),_=(0,m.default)(o.default).withConfig({displayName:"WebSocketConnectionTabs__StyledText",componentId:"postman-app__sc-1mcodaw-1"})(["margin-left:var(--spacing-xs);line-height:var(--line-height-s);"]);let T=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleTabSelect=this.handleTabSelect.bind(this)}getMeta(e){return e&&n.createElement("div",{className:"websocket-tabs-badge"})}getCount(e,t){return e&&n.createElement(_,{color:"content-color-success"},"(",t,")")}getTabsList(){const e=[];return e.push({refKey:g.WEBSOCKET_MESSAGES,label:"Message"}),this.props.model.type===g.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&e.push({refKey:g.WEBSOCKET_CONNECTION_EVENTS,label:"Events ",getBadge:()=>this.getCount(!S.isEmpty(this.props.model.events),this.props.model.events.length)}),e.push({refKey:g.WEBSOCKET_CONNECTION_QUERY_PARAMS,label:"Params",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.queryParams))}),e.push({refKey:g.WEBSOCKET_CONNECTION_HEADERS,label:"Headers",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.headers))}),e.push({refKey:g.WEBSOCKET_CONNECTION_SETTINGS,label:"Settings",getBadge:()=>this.getMeta(!S.isEmpty(this.props.model.settings))}),e}handleTabSelect(e){this.props.model.set("activeConnectionTab",e),this.props.onSelect&&this.props.onSelect()}renderToggle(e,t){let s=e===p.REQUESTER_TAB_LAYOUT_1_COLUMN?l.default:c.default;return t&&e===p.REQUESTER_TAB_LAYOUT_1_COLUMN&&(s=d.default),n.createElement(s,{color:"content-color-tertiary"})}render(){const{isCollapsed:e,layout:t,model:s,connectionPaneWidth:a}=this.props,i=a()<u.default.ui.WEBSOCKET_REQUEST_TAB_THRESHOLD?E.DROPDOWN:E.HORIZONTAL_LIST;return n.createElement(h.Flex,{alignItems:"center"},n.createElement(r.default,{activeTab:s.activeConnectionTab,tabsList:this.getTabsList(),tabsListType:i,onTabSelect:this.handleTabSelect,isCollapsed:e}),n.createElement(y,{className:"websocket-message-pane-label__actions__arrow",onClick:this.props.onClick},this.renderToggle(t,e)))}})||a},12224:function(e,t,s){s.r(t);var a=s(1),n=s(2417),i=s(2399),r=s(4898),o=s(5463);const l=n.default.div.withConfig({displayName:"WebSocketEvents__HighlightBox",componentId:"postman-app__sc-2gj8hd-0"})(["position:relative;::before{content:'';display:block;position:absolute;top:0px;bottom:0px;left:0px;right:0px;pointer-events:none;background-color:transparent;transition:background-color 1.2s;","}"],(e=>e.highlight&&(0,n.css)(["background-color:var(--background-color-info);transition:background-color 0.1s;"]))),c=[{key:"name",label:"Events",placeholder:"Add event",type:"string",width:"340px",addField:!0,unique:!0,sortable:!0},{key:"subscribeOnConnect",label:"Listen",type:"boolean",width:"82px"}];t.default=(0,i.observer)((({model:e,highlight:t})=>{const s=a.useRef(-1),n=e.status===o.CONNECTED;return c[0].onEdit=(t,a)=>{n&&a<e.events.length&&(s.current=a,e.unsubscribe(e.events[a].name,a))},c[1].onToggle=(t,s)=>{n&&e.toggleSubscription(t.name,s)},a.createElement(l,{className:"websocket-events",highlight:t},a.createElement(r.TableEditor,{columns:c,rows:e.events,onUpdate:t=>{-1!==s.current&&(t[s.current].subscribeOnConnect=!1),e.set("events",t),s.current=-1},onDelete:t=>e.unsubscribe(t.name),deleteIconStyles:{position:"absolute",rightSpacing:"var(--spacing-xs)"}}))}))},12225:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a,n=s(1),i=s(2399),r=s(2403),o=s.n(r),l=s(4441),c=s(5507),d=s(12226),p=s(40);let u=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleHeadersChange=this.handleHeadersChange.bind(this)}handleHeadersChange(e){const{model:t}=this.props;t.connectionConfigEditDisabled||t.set("headers",p.map(e,(e=>p.pick(e,["key","value","description","enabled"]))))}render(){const{model:e}=this.props;return n.createElement("div",{className:o()({"layout-1-column":!0,"websocket-headers":!0})},n.createElement(l.default,{onChange:this.handleHeadersChange,headers:e.headers||[],readOnly:e.connectionConfigEditDisabled,keySuggestions:(0,c.getHeadersKeySuggestions)(),previewHeaders:(0,d.getPreviewHeaders)(),prepareHeadersForPreview:d.prepareHeadersForPreview,canOverridePreviewHeader:d.canOverridePreviewHeader}))}})||a},12228:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var a,n=s(1),i=s(2399),r=s(1039),o=s(4447),l=s(40);let c=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleParamsChange=this.handleParamsChange.bind(this)}handleParamsChange(e,t){const{model:s}=this.props;s.connectionConfigEditDisabled||(0,r.transaction)((()=>{s.set("queryParams",l.map(e,(e=>{const t=l.pick(e,["key","value","description","enabled"]);return"string"!=typeof t.description&&delete t.description,t}))),s.set("url",t)}))}render(){const{model:e}=this.props;return n.createElement("div",{className:"websocket-query-params"},n.createElement(o.default,{url:e.url||"",params:e.queryParams||[],onParamsChange:this.handleParamsChange,readOnly:e.connectionConfigEditDisabled}))}})||a},12227:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a,n=s(1),i=s(2399),r=s(4507),o=s(5508),l=s(5463),c=s(40);let d=(0,i.observer)(a=class extends n.Component{handleFieldChange(e,t){const{model:s}=this.props;if(s.connectionConfigEditDisabled)return;const a=s.settings||{};s.set("settings",{...a,[e]:t})}handleRestoreDefault(e){const{model:t}=this.props;if(t.connectionConfigEditDisabled)return;const s={...t.settings||{}};delete s[e],t.set("settings",s)}render(){const{model:e}=this.props,t=e.type===l.WEBSOCKET_REQUEST_TYPE.SOCKETIO?o.SOCKETIO_CONNECTION_CONFIG:l.WS_CONNECTION_CONFIG;return n.createElement("div",{className:"websocket-settings"},c.map(t,(t=>n.createElement(r.default,{key:t.id,title:t.title,description:t.description,value:c.get(e.settings,[t.id]),defaultValue:t.defaultValue,inputFieldType:t.inputFieldType,inputType:t.inputType,handleFieldChange:this.handleFieldChange.bind(this,t.id),handleRestoreDefault:this.handleRestoreDefault.bind(this,t.id),menuOptions:t.menuOptions,menuLabels:t.menuLabels,disabled:e.connectionConfigEditDisabled,id:t.id}))))}})||a},12221:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var a,n=s(1),i=s(1039),r=s(2399),o=s(3202),l=s(4448),c=s(2417),d=s(4898),p=s(5474),u=s(5507),h=s(5463),m=s(40);const E=(0,c.default)(d.Button).withConfig({displayName:"WebSocketURLEditor__StyledButton",componentId:"postman-app__sc-j6fpf6-0"})(["height:fit-content;align-self:start;padding:var(--spacing-m) var(--spacing-l);width:80px;"]),g=c.default.div.withConfig({displayName:"WebSocketURLEditor__WebSocketURLContainer",componentId:"postman-app__sc-j6fpf6-1"})(["display:flex;padding:var(--spacing-s) var(--spacing-l);align-items:center;"]),S=c.default.div.withConfig({displayName:"WebSocketURLEditor__UrlWrapper",componentId:"postman-app__sc-j6fpf6-2"})(["display:flex;flex:1;width:100%;height:40px;box-sizing:border-box;& > *:not(:last-child){margin-right:var(--spacing-s);}"]);let y=(0,r.observer)(a=class extends n.Component{constructor(e){super(e),this.handleConnection=this.handleConnection.bind(this),this.handleUrlChange=this.handleUrlChange.bind(this),this.state={isFocused:!1,connectError:!1,requestType:e.model.type},this.urlEditorRef=n.createRef(null)}componentDidUpdate(e){this.props.model.type!==e.model.type&&this.setState({connectError:!1})}handleUrlChange(e){const{model:t}=this.props;if(t.connectionConfigEditDisabled)return;const s=(0,l.handleParamsChange)(e,t.queryParams||[]);(0,i.transaction)((()=>{this.setState({connectError:!1}),t.set("url",e),t.set("queryParams",m.map(s,(e=>{const t=m.pick(e,["key","value","description","enabled"]);return"string"!=typeof t.description&&delete t.description,t})))}))}handleConnection(){const e=h.WEBSOCKET_STATUS_TO_ACTION_MAP[this.props.model.status],{handler:t}=h.ACTION_TO_BUTTON_MAP[e];if(e===h.CONNECT){if(this.connectDisabled)return void this.setState({connectError:!0});p.default.setNonHTTPRequestSent()}!0===this.state.connectError&&this.setState({connectError:!1}),t&&this.props.model[t]&&this.props.model[t]()}static getDerivedStateFromProps(e,t){return e.model.type!==t.requestType?{isFocused:!1,requestType:e.model.type}:null}render(){const{url:e,status:t,connectionConfigEditDisabled:s,type:a,collection:i,context:r}=this.props.model,l=h.WEBSOCKET_STATUS_TO_ACTION_MAP[t],{label:c}=h.ACTION_TO_BUTTON_MAP[l],{isDisabled:p,reason:m}=(0,u.isConnectDisabled)(a,e),y="OSX"===pm.app.get("platform"),_=l===h.CONNECT?n.createElement(o.default,{content:y?"â†µ":"Enter",placement:"bottom"}):void 0;return this.connectDisabled=p,n.createElement(g,null,n.createElement(S,null,n.createElement(d.URLSuggestionsPopover,{trigger:n.createElement(d.AutoSuggestInput,{baseAutoSuggestKey:this.props.model.type,ref:this.urlEditorRef,enableVariableSuggestions:!0,error:this.state.connectError&&m?m:null,onChange:this.handleUrlChange,onHardFocus:()=>this.setState({isFocused:!0}),onSubmit:this.handleConnection,placeholder:"Enter URL",preventEnter:!0,readOnly:s,value:e,shouldFocusOnMount:!(i||null!=r&&r.isHistory),shouldHaveBorderHighlight:this.state.isFocused,dataTestId:`${this.props.model.type}-url-bar`}),attachTo:this.urlEditorRef,onChange:this.handleUrlChange,onClickOutside:()=>this.setState({isFocused:!1}),showSuggestions:this.state.isFocused,value:e,type:this.props.model.type}),n.createElement(E,{variant:l===h.CONNECT?"cta":"secondary",onClick:this.handleConnection,text:c,tooltip:_,"data-testid":"ws-raw-connect-button",className:"webSocketConnect"})))}})||a},12205:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a,n=s(1),i=s(2399),r=s(2402),o=s(3194),l=s(2213),c=s(2405),d=s(4363),p=s(4898),u=s(2417),h=s(12206),m=s(12218),E=s(12221),g=s(12222),S=s(12223),y=s(12235),_=s(12236),T=s(5463);const f={[d.REQUESTER_TAB_LAYOUT_1_COLUMN]:c.PANE_LAYOUT_VERTICAL,[d.REQUESTER_TAB_LAYOUT_2_COLUMN]:c.PANE_LAYOUT_HORIZONTAL},b=(0,u.default)(r.PaneGroup).withConfig({displayName:"WebSocketEditor__StyledPaneGroup",componentId:"postman-app__sc-14co8ht-0"})([".pane-label{.pane-label__text{font-family:var(--text-family-default);font-weight:var(--text-weight-bold);font-size:var(--text-size-m);line-height:var(--line-height-m);color:var(--content-color-primary);}&.horizontal{.pane-label__text{margin-left:var(--spacing-l);}.pane-label__arrow{margin-right:var(--spacing-l);}}}"]);let v=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleStreamPaneToggle=this.handleStreamPaneToggle.bind(this),this.handleConnectionPaneToggle=this.handleConnectionPaneToggle.bind(this),this.unCollapseConnectionPane=this.unCollapseConnectionPane.bind(this),this.currentLayout=e.model.layoutName,this.connectionPaneWidth=this.connectionPaneWidth.bind(this),this.state={highlightEventsTab:!1}}componentDidUpdate(){const e=this.props.model.layoutName;this.currentLayout!==e&&(this.currentLayout=e,this.editorPaneGroupRef&&"function"==typeof this.editorPaneGroupRef.setLayout&&this.editorPaneGroupRef.setLayout(f[this.currentLayout]))}connectionPaneWidth(){return this.connectionPaneRef&&this.connectionPaneRef.state.width}handleStreamPaneToggle(){this.streamPaneRef&&(this.currentLayout===d.REQUESTER_TAB_LAYOUT_1_COLUMN?this.streamPaneRef.handleCollapseToggle("y"):this.streamPaneRef.handleCollapseToggle("x"))}handleConnectionPaneToggle(){this.connectionPaneRef&&(this.currentLayout===d.REQUESTER_TAB_LAYOUT_1_COLUMN?this.connectionPaneRef.handleCollapseToggle("y"):this.connectionPaneRef.handleCollapseToggle("x"))}unCollapseConnectionPane(){this.connectionPaneRef&&this.connectionPaneRef.unCollapse("y")}renderCoreEditor(){const{model:e}=this.props;return n.createElement(p.View,{position:"relative",height:"full",width:"full"},n.createElement(p.Flex,{position:"absolute",isColumn:!0,height:"full",width:"full"},n.createElement(_.default,{model:e,switchType:this.props.switchType}),n.createElement(E.default,{model:e}),n.createElement(b,{defaultLayout:f[e.layoutName],key:"WebsocketRequestPaneGroup",onPaneResize:this.handlePaneResize,ref:e=>{this.editorPaneGroupRef=e}},n.createElement(r.Pane,{height:{default:l.default.ui.WEBSOCKET_REQUEST_URL_PANE_DEFAULT_HEIGHT,min:l.default.ui.WEBSOCKET_REQUEST_URL_PANE_MIN_HEIGHT,collapsed:l.default.ui.WEBSOCKET_REQUEST_URL_PANE_COLLAPSED_HEIGHT,uncollapsed:l.default.ui.WEBSOCKET_REQUEST_URL_PANE_UNCOLLAPSED_HEIGHT},width:{default:l.default.ui.WEBSOCKET_REQUEST_PANE_DEFAULT_WIDTH,min:l.default.ui.WEBSOCKET_REQUEST_PANE_EDITOR_OPEN_MIN_WIDTH,collapsed:l.default.ui.WEBSOCKET_REQUEST_PANE_COLLAPSED_WIDTH,uncollapsed:l.default.ui.WEBSOCKET_REQUEST_PANE_UNCOLLAPSED_WIDTH},ref:e=>{this.connectionPaneRef=e}},n.createElement(r.PaneHeader,{height:32,width:l.default.ui.WEBSOCKET_REQUEST_PANE_COLLAPSED_WIDTH,defaultLayout:c.PANE_LAYOUT_HORIZONTAL,horizontalComponent:n.createElement(g.default,{model:e,onSelect:this.unCollapseConnectionPane,onClick:this.handleConnectionPaneToggle,layout:e.layoutName,connectionPaneWidth:this.connectionPaneWidth}),verticalComponent:n.createElement(r.PaneLabel,{layout:c.PANE_LAYOUT_VERTICAL,label:n.createElement(o.default,{type:"body-medium",color:"content-color-secondary"},"Request"),arrowDirection:"right",onClick:this.handleConnectionPaneToggle})}),n.createElement(r.PaneContent,{height:{default:l.default.ui.WEBSOCKET_REQUEST_URL_PANE_DEFAULT_HEIGHT}},n.createElement(S.default,{model:e,highlightEventsTab:this.state.highlightEventsTab}))),n.createElement(r.Pane,{ref:e=>{this.streamPaneRef=e},height:{default:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_DEFAULT_HEIGHT,min:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_MIN_HEIGHT,collapsed:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_HEIGHT,uncollapsed:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_UNCOLLAPSED_HEIGHT},width:{default:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_DEFAULT_WIDTH,min:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_MIN_WIDTH,collapsed:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_WIDTH,uncollapsed:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_UNCOLLAPSED_WIDTH}},n.createElement(r.PaneHeader,{height:32,width:l.default.ui.WEBSOCKET_REQUEST_MESSAGES_PANE_COLLAPSED_WIDTH,defaultLayout:c.PANE_LAYOUT_HORIZONTAL,horizontalComponent:n.createElement(y.default,{label:"Response",icon:e=>e?"icon-direction-up":"icon-direction-down",status:e.badgeStatus,statistics:e.connectionStatistics,onClick:this.handleStreamPaneToggle,layout:e.layoutName,model:e,onHighLightEventsTab:()=>{this.setState({highlightEventsTab:!0}),setTimeout((()=>this.setState({highlightEventsTab:!1})),200)}}),verticalComponent:n.createElement(r.PaneLabel,{layout:c.PANE_LAYOUT_VERTICAL,label:n.createElement(o.default,{type:"body-medium",color:"content-color-secondary"},"Response"),arrowDirection:"left",onClick:this.handleStreamPaneToggle})}),n.createElement(r.PaneContent,null,e.type===T.WEBSOCKET_REQUEST_TYPE.RAW?n.createElement(h.default,{model:e}):n.createElement(m.default,{model:e}))))))}render(){return this.renderCoreEditor()}})||a},12236:function(e,t,s){s.r(t);var a=s(1),n=s(3573),i=s(5027),r=s(2399),o=s(3284),l=s(3555),c=s(5097),d=s(5080),p=s(3562),u=s(5096),h=s(4367),m=s(6252),E=s(6254),g=s(2082),S=s(5583),y=s(5573),_=s(2502),T=s(5580),f=s(2387),b=s(40);const v=(0,r.observer)((e=>{const{requestSDK:t}=e.model,s=(0,a.useRef)(null),{isSavedRequest:r}=e.model,v=t.isOnline(),C=t.hasPermission(e.model.id,d.ItemAction.SAVE),M=v&&C,O=(e.model.isDirty||!r)&&M,A=v,N=g.default.isEnabled,w=()=>{if(r)return e.model.requestWorkbenchSave&&e.model.requestWorkbenchSave();e.model.saveAs()},I=(t,a)=>{e.model.requestSDK.menuActionHandler(e.model.id,t,a).then((()=>{if(t===d.ItemAction.RENAME_TOGGLE)b.invoke(s,"current.handleEditName")}))},k=()=>A?"Save request to a collection":v?p.DISABLED_TOOLTIP_NO_PERMISSION:p.DISABLED_TOOLTIP_IS_OFFLINE;return(0,a.useEffect)((()=>{const{model:t}=e;b.get(t,"context.rename")&&(I(d.ItemAction.RENAME_TOGGLE),t&&b.isFunction(t.unsetContext)&&t.unsetContext("rename"))}),[]),a.createElement(l.default,{className:"websocket-editor-header",ref:s,name:e.model.name,path:e.model.breadcrumbPath,entityType:`ec:${t.type}`,entityUID:e.model.isSavedRequest?e.model.id:null,isEntityEditable:M&&e.model.isSavedRequest,onBreadCrumbItemClick:e=>{if(e)if(e.type===u.COLLECTION)c.default.openInTab(e.id);else{const t=pm.ECItemRegistry.getSDK(e.type);t&&t.openInTab(e.id)}},onSubmit:e=>I(d.ItemAction.RENAME,{name:e}),leftMetaComponent:()=>{var s,n;return a.createElement(y.default,{activeValue:t.type,tabId:e.model.context.tabId,canSwitch:!(r||null!==(s=e.model)&&void 0!==s&&null!==(n=s.context)&&void 0!==n&&n.isHistory),beforeSwitch:()=>e.model.cacheUpdatesBuffer()})},renderActions:()=>a.createElement("div",{className:"websocket-editor-header__actions"},a.createElement("div",{className:"request-editor-save-button"},N?(()=>{const e=a.createElement(n.default,{icon:a.createElement(_.default,null),text:"Save",type:"tertiary","data-testid":"add-to-collection-button"});return a.createElement(i.default,{placement:"bottom-end",padding:"spacing-xs",maxWidth:"350px",trigger:e,pointer:"true"},a.createElement(T.default,{title:S.GENERIC_SIGNIN_MODAL_TITLE,subtitle:S.GENERIC_SIGNIN_MODAL_SUBTITLE}))})():a.createElement(o.Dropdown,{onSelect:()=>e.model.saveAs()},a.createElement(o.DropdownButton,{dropdownStyle:"split",type:"secondary"},a.createElement("div",null,a.createElement(n.default,{type:"secondary",text:"Save",icon:"icon-action-save-stroke",onClick:w,isDisabled:r?!O:!A,tooltip:r?v?C?e.model.isDirty?"Save request":"No new changes to save.":p.DISABLED_TOOLTIP_NO_PERMISSION:p.DISABLED_TOOLTIP_IS_OFFLINE:k()}))),a.createElement(o.DropdownMenu,{"align-right":!0,className:"request-editor-save-button-dropdown"},a.createElement(o.MenuItem,{refKey:"save-as",disabled:!A,disabledText:k()},a.createElement("div",{className:"dropdown-menu-item-label"},"Save As.."),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,h.getShortcutByName)("saveCurrentRequestAs")))))),f.default.isUseBrowserTabsActive()&&a.createElement("div",{className:"environment-container"},a.createElement(m.default,{selectorWidth:130,useBrowserTabs:!0}),a.createElement("div",{className:"environment-splitter"}),a.createElement(E.default,{useBrowserTabs:!0}))),breadCrumbRouteConfig:e=>{if(e)return e.type===u.COLLECTION?{routeIdentifier:"build.collection",routeParams:{cid:e.id},queryParams:null}:pm.ECItemRegistry.getSDK(e.type)?{routeIdentifier:pm.ECItemRegistry.getSDK(e.type).openSavedIdentifier,routeParams:{ecid:e.id},queryParams:{}}:null}})}));t.default=v},12208:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a,n=s(1),i=s(2399),r=s(3194),o=s(3573),l=s(2406),c=s(40);let d=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleRestore=this.handleRestore.bind(this)}handleRestore(){this.props.model.restoreHiddenMessages&&this.props.model.restoreHiddenMessages()}render(){return n.createElement("div",{className:"websocket-hidden-messages"},n.createElement("div",{className:"websocket-hidden-messages__left-section"},n.createElement(l.default,{name:"icon-action-hide-stroke",color:"content-color-primary",size:"large",className:"websocket-hidden-messages__left-section__icon"}),n.createElement(r.default,{type:"body-medium",color:"content-color-primary"},`${c.get(this.props.model,"firstVisibleMessageIndex")} messages hidden`)),n.createElement("div",{className:"websocket-hidden-messages__right-section"},n.createElement(o.default,{type:"secondary",text:"Restore",size:"small",onClick:this.handleRestore})))}})||a},12216:function(e,t,s){s.r(t),s.d(t,{default:function(){return S}});var a,n=s(1),i=s(2403),r=s.n(i),o=s(2399),l=s(3573),c=s(5419),d=s(4168),p=s(3594),u=s(5464),h=s(12217),m=s(5507),E=s(5463),g=s(40);let S=(0,o.observer)(a=class extends n.Component{constructor(e){super(e),this.loadMedia=this.loadMedia.bind(this),this.handleBeautify=this.handleBeautify.bind(this),this.toggleLineWrap=this.toggleLineWrap.bind(this),this.toggleFindWidget=this.toggleFindWidget.bind(this),this.toggleHexdump=this.toggleHexdump.bind(this),this.handleMessageLanguageChange=this.handleMessageLanguageChange.bind(this)}getToolbarClasses(){return r()({"websocket-message-viewer__editor__toolbar":!0,"is-binary":null===g.get(this.props,"cachedState.activeLanguage")})}getLineWrapButtonClasses(){return r()({"line-wrap-active":g.get(this.props,"cachedState.lineWrap")})}loadMedia(e){const t={mediaType:this.props.mimeType,fileExtension:this.props.fileExtension};pm.runtime.getPreviewFile(e,t,((e,t)=>{if(e)return pm.logger.error("ResponsePreviewService~saveMediaResponseV2: Could not save preview.",e);this.props.onMediaSave&&this.props.onMediaSave(t.value)}))}handleStateUpdate(e={}){this.props.updateState(g.assign({activeLanguage:g.get(this.props,"cachedState.activeLanguage"),lineWrap:g.get(this.props,"cachedState.lineWrap"),hexMode:g.get(this.props,"cachedState.hexMode")},e))}handleMessageLanguageChange(e){this.handleStateUpdate({activeLanguage:e,hexMode:!1})}handleBeautify(){this.editorRef&&this.editorRef.prettify()}toggleLineWrap(){this.handleStateUpdate({lineWrap:!g.get(this.props,"cachedState.lineWrap")})}toggleFindWidget(){this.editorRef&&this.editorRef.toggleFindWidget()}toggleHexdump(){this.handleStateUpdate({hexMode:!g.get(this.props,"cachedState.hexMode")})}renderIFrame(e){return!this.props.mediaFilePath&&this.loadMedia(e),n.createElement("div",{className:"websocket-message-viewer__iframe"},this.props.mediaFilePath?n.createElement(c.default,{responseStream:e,url:this.props.mediaFilePath}):n.createElement(d.default,null))}renderEditor(e){const{activeLanguage:t,lineWrap:s,hexMode:a}=this.props.cachedState||{};let i=g.get(this.props,"cachedState.activeLanguage");return a?i=u.WebSocketMessageBodyType.HEXDUMP:g.isNil(t)&&(i=u.WebSocketMessageBodyType.TEXT),n.createElement("div",{className:"websocket-message-viewer__editor"},n.createElement("div",{className:this.getToolbarClasses()},!g.isNil(t)&&n.createElement("div",{className:"websocket-message-viewer__editor__toolbar__section-l"},n.createElement(h.default,{onChange:this.handleMessageLanguageChange,activeLanguage:t}),n.createElement(l.default,{onClick:this.toggleLineWrap,type:"tertiary",icon:"icon-action-wrap-stroke",tooltip:"Wrap Line",className:this.getLineWrapButtonClasses(),isDisabled:a}),!this.props.autoFormat&&n.createElement(l.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify",isDisabled:a})),n.createElement("div",{className:"websocket-message-viewer__editor__toolbar__section-r"},n.createElement(l.default,{onClick:this.toggleHexdump,type:"tertiary",text:a?"Show Message":"Show Hexdump"}),n.createElement(l.default,{onClick:this.toggleFindWidget,type:"tertiary",icon:"icon-action-search-stroke",tooltip:"Search"}))),n.createElement("div",{className:"websocket-message-viewer__editor__monaco-editor"},n.createElement(p.default,{autoFormat:this.props.autoFormat,value:e,fontSize:12,language:i,wordWrap:s,readOnly:!0,ref:e=>{this.editorRef=e}})))}render(){const{message:e,viewer:t}=(0,m.transformMessage)(this.props.message,this.props.mimeType,g.get(this.props,"cachedState.hexMode"));return this.transformedMessage=e,t===E.IFRAME?this.renderIFrame(e):this.renderEditor(e)}})||a;S.defaultProps={autoFormat:!0}},12217:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a=s(1),n=s(3284),i=s(2784),r=s(5464),o=s(5463),l=s(40);const c={[r.WebSocketMessageBodyType.TEXT]:o.USER_FRIENDLY_LANGUAGE_NAME[r.WebSocketMessageBodyType.TEXT],[r.WebSocketMessageBodyType.HTML]:o.USER_FRIENDLY_LANGUAGE_NAME[r.WebSocketMessageBodyType.HTML],[r.WebSocketMessageBodyType.POSTMAN_JSON]:o.USER_FRIENDLY_LANGUAGE_NAME[r.WebSocketMessageBodyType.POSTMAN_JSON],[r.WebSocketMessageBodyType.XML]:o.USER_FRIENDLY_LANGUAGE_NAME[r.WebSocketMessageBodyType.XML]};function d(e){const t=e.languageMap||c;return a.createElement(n.Dropdown,{className:e.className,onSelect:e.onChange},a.createElement(n.DropdownButton,{type:"tertiary",size:"small"},a.createElement(i.Button,{className:"websocket-message-lang-dropdown-btn"},t[e.activeLanguage])),a.createElement(n.DropdownMenu,{fluid:!0},l.map(t,((e,t)=>a.createElement(n.MenuItem,{refKey:t,key:t},a.createElement("span",null,e))))))}},12235:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a,n=s(1),i=s(2399),r=s(2417),o=s(3267),l=s(3194),c=s(3570),d=s(3573),p=s(2785),u=s(2627),h=s(2633),m=s(2635),E=s(4363),g=s(5463),S=s(40);const y=(0,r.default)(o.default).withConfig({displayName:"WebSocketMessagePaneLabel__StyledFlex",componentId:"postman-app__sc-1wmdki6-0"})(["cursor:default;"]),_=r.default.div.withConfig({displayName:"WebSocketMessagePaneLabel__StyledDiv",componentId:"postman-app__sc-1wmdki6-1"})(["display:flex;align-items:center;gap:var(--spacing-s);"]),T=r.default.div.withConfig({displayName:"WebSocketMessagePaneLabel__StyledBadge",componentId:"postman-app__sc-1wmdki6-2"})(["display:inline-flex;width:8px;height:8px;margin-left:var(--spacing-xs);background-color:",";border-radius:8px;"],(({status:e})=>{switch(e){case"success":return"var(--base-color-success)";case"info":return"var(--base-color-warning)";case"critical":return"var(--base-color-error)"}}));function f(e){const{label:t,value:s}=e;return t&&s?n.createElement("div",{className:"websocket-connection-statistics__item"},n.createElement(l.default,{type:"body-medium",color:"content-color-secondary",className:"websocket-connection-statistics__item__label"},t),n.createElement("div",{className:"websocket-connection-statistics__item__value",title:s},n.createElement(l.default,{type:"body-medium",color:"content-color-primary"},s))):null}function b(e){if(!e.section)return null;const{section:t,dataFields:s}=e.section;return n.createElement(n.Fragment,null,t&&n.createElement("div",{className:"websocket-connection-statistics__item"},n.createElement(c.default,{type:"h5",color:"content-color-secondary",text:t,className:"websocket-connection-statistics__item__header"})),S.map(s,(({key:t,label:s,formatter:a})=>{const i=S.get(e.statistics,[t]);return n.createElement(f,{key:t,label:s,value:S.isFunction(a)?a(i):i})})))}let v=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.state={isStatisticsVisible:!1},this.showStatistics=this.showStatistics.bind(this),this.hideStatistics=this.hideStatistics.bind(this),this.openEventsTab=this.openEventsTab.bind(this)}showStatistics(){this.props.statistics&&(this.dismissTooltipTimeout&&clearTimeout(this.dismissTooltipTimeout),this.dismissTooltipTimeout=setTimeout((()=>{this.setState({isStatisticsVisible:!0})}),100))}hideStatistics(){this.props.statistics&&(this.dismissTooltipTimeout&&clearTimeout(this.dismissTooltipTimeout),this.dismissTooltipTimeout=setTimeout((()=>{this.setState({isStatisticsVisible:!1})}),300))}openEventsTab(){this.props.model.activeConnectionTab===g.WEBSOCKET_CONNECTION_EVENTS?this.props.onHighLightEventsTab():this.props.model.set("activeConnectionTab",g.WEBSOCKET_CONNECTION_EVENTS)}renderToggle(e,t){let s=e===E.REQUESTER_TAB_LAYOUT_1_COLUMN?u.default:h.default;return t&&e===E.REQUESTER_TAB_LAYOUT_1_COLUMN&&(s=m.default),n.createElement(s,{color:"content-color-tertiary"})}render(){var e;const{status:t,icon:s,isCollapsed:a,layout:i,model:r}=this.props,{label:o,type:u}=g.WEBSOCKET_STATUS_TO_BADGE_MAP[t]||{},h=S.isString(s)?s:S.isFunction(s)&&s(this.props.isCollapsed),m=null!==(e=r.activeEventsCount)&&void 0!==e?e:0,E=r.activeEventsCount<1?"Not listening to events":`Listening to ${m} ${"1"===m?"event":"events"}`;return n.createElement("div",{className:"websocket-message-pane-label"},n.createElement("div",{className:"websocket-message-pane-label__text",onClick:this.props.onClick},n.createElement(c.default,{type:"h5",text:this.props.label,color:"content-color-primary"})),n.createElement("div",{className:"websocket-message-pane-label__actions"},o&&u&&n.createElement(n.Fragment,null,n.createElement(y,{alignItems:"center",gap:"spacing-xs"},(null==r?void 0:r.type)===g.WEBSOCKET_REQUEST_TYPE.SOCKETIO&&r.status!==g.IDLE?n.createElement(d.default,{type:"tertiary",size:"small",text:E,onClick:this.openEventsTab}):null,n.createElement(_,{onMouseEnter:this.showStatistics,onMouseLeave:this.hideStatistics,ref:e=>{this.badgeRef=e}},n.createElement(T,{status:u}),n.createElement(l.default,{"data-testid":"websocket-connection-status-label"},o))),!S.isEmpty(this.props.statistics)&&n.createElement(p.Tooltip,{placement:"bottom",className:"websocket-connection-statistics",target:this.badgeRef,show:this.state.isStatisticsVisible,onMouseEnter:this.showStatistics,onMouseLeave:this.hideStatistics,immediate:!0},n.createElement(p.TooltipBody,null,S.map(g.WS_CONNECTION_STATS_TEMPLATE,((e,t)=>n.createElement(b,{key:t,section:e,statistics:this.props.statistics})))))),h&&n.createElement("div",{className:"websocket-message-pane-label__actions__arrow",onClick:this.props.onClick},this.renderToggle(i,a))))}})||a},12207:function(e,t,s){s.r(t),s.d(t,{default:function(){return M}});var a,n=s(1),i=s(1039),r=s(2399),o=s(3271),l=s(2403),c=s.n(l),d=s(3573),p=s(3569),u=s(12213),h=s(12214),m=s(5130),E=s(4470),g=s(2108),S=s(4168),y=s(3572),_=s(12208),T=s(12209),f=s(12212),b=s(5463),v=s(40);const C=(0,r.observer)((e=>e.model.messageStreamNotificationType?n.createElement("div",{className:"websocket-stream__jump-to-latest"},n.createElement(d.default,{type:"tertiary",size:"small",text:e.model.messageStreamNotificationType===b.MESSAGE_STREAM_NOTIFICATION_NEW?"New messages":"Jump to latest",icon:"icon-direction-ascend-small",className:"websocket-stream__jump-to-latest__btn",onClick:e.handleJumpToLatest})):null));let M=(0,r.observer)(a=class extends n.Component{constructor(e){super(e),this.state={retryCount:0},this.handleMessageLoadRetry=this.handleMessageLoadRetry.bind(this),this.getItemSize=this.getItemSize.bind(this),this.getListItem=this.getListItem.bind(this),this.onItemsRendered=this.onItemsRendered.bind(this),this.handleJumpToLatest=this.handleJumpToLatest.bind(this),this.handleListScroll=this.handleListScroll.bind(this)}componentDidMount(){const{model:e}=this.props;this.resetHeightReactionDisposer=(0,i.reaction)((()=>e.visibleItems),(()=>this.handleResetHeight(0))),this.newMessageNotificationReactionDisposer=(0,i.reaction)((()=>v.size(e.newMessages)),(t=>{if(0===t)return e.set("messageStreamNotificationType",null);e.set("messageStreamNotificationType",b.MESSAGE_STREAM_NOTIFICATION_NEW)}))}componentWillUnmount(){this.resetHeightReactionDisposer&&this.resetHeightReactionDisposer(),this.newMessageNotificationReactionDisposer&&this.newMessageNotificationReactionDisposer()}onItemsRendered({visibleStartIndex:e}){e<10||v.size(this.props.model.newMessages)||this.props.model.set("messageStreamNotificationType",b.MESSAGE_STREAM_NOTIFICATION_JUMP_TO_LATEST)}get emptyState(){return{error:{title:{text:"Couldnâ€™t load your messages."},message:{text:this.state.retryCount<3?"Just a faulty wire. Please try again.":"We are unable to load your messages due to unforeseen circumstances. Please try again later.",className:"stream-empty-state__message"},illustration:n.createElement(p.default,null),secondaryAction:this.state.retryCount<3?{label:"Retry",type:"outline",onClick:this.handleMessageLoadRetry}:{}},empty:{message:{text:"Establish a connection to send and receive messages.",className:"stream-empty-state__message"},illustration:n.createElement(u.default,null)}}}getMessageIndex(e){return v.size(this.props.model.visibleItems)-(e+1)}getItemSize(e){const{model:t}=this.props,{id:s,type:a,payload:n}=v.get(t,["visibleItems",this.getMessageIndex(e)],{});return t.expandedMessageSet.has(s)?a===b.WEBSOCKET_ERROR_MESSAGE||a===b.WEBSOCKET_CONNECTED_MESSAGE?n&&v.isNil(n.handshakeDetails)?73:281:a===b.WEBSOCKET_DISCONNECTED_MESSAGE?73:291:41}getListItem(e){const{model:t}=this.props,s=v.get(t,["visibleItems",this.getMessageIndex(e.index)]);return s?s.type===b.WEBSOCKET_HIDDEN_MESSAGE?n.createElement("div",{style:e.style},n.createElement(_.default,{model:t})):n.createElement("div",{style:e.style},this.props.renderListItem(e.index,s)):null}getList(){const e=e=>n.createElement(r.Observer,null,this.getListItem.bind(this,e)),t=({height:t,width:s})=>n.createElement(r.Observer,null,(()=>n.createElement(o.VariableSizeList,{height:t,width:s,itemSize:this.getItemSize,itemCount:v.size(this.props.model.visibleItems),overscanCount:5,ref:e=>{this.listRef=e},onItemsRendered:this.onItemsRendered,onScroll:this.handleListScroll},e)));return n.createElement("div",{className:"websocket-stream__list"},n.createElement(m.default,null,t))}handleMessageLoadRetry(){this.setState((e=>({retryCount:e.retryCount+1}))),this.props.model.set("messageStreamStatus",b.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading),f.default.fetchHistoryMessages((0,E.resolveStoreInstance)(g.default).id,this.props.model.id).then((e=>{this.props.model.onMessageStreamFetch(null,e)})).catch((e=>{this.props.model.onMessageStreamFetch(e),pm.logger.error("Error in loading message stream",e)}))}handleResetHeight(e){!v.isEmpty(this.listRef)&&this.listRef.resetAfterIndex(e)}handleJumpToLatest(e){e&&e.stopPropagation(),!v.isEmpty(this.listRef)&&this.listRef.scrollToItem(0)}handleListScroll({scrollOffset:e}){if(this.toolbarRef&&this.toolbarRef.onScroll(e),0===e){const e=this.props.model.messageStreamNotificationType;(0,i.transaction)((()=>{v.size(this.props.model.newMessages)&&this.props.model.flushNewMessages(),this.props.model.set("messageStreamNotificationType",null)})),e===b.MESSAGE_STREAM_NOTIFICATION_NEW&&this.handleResetHeight(0)}this.props.model.set("scrollOffset",e)}renderContent(){const{model:e}=this.props;return e.isFilterApplied&&v.isEmpty(e.filteredMessages)?n.createElement(y.default,{className:"stream-empty-state",illustration:n.createElement(h.default,null),title:{text:"No messages found"},message:{text:"Try again using a different keyword or filter."}}):n.createElement(n.Fragment,null,n.createElement(C,{model:e,handleJumpToLatest:this.handleJumpToLatest}),this.getList())}render(){const{model:e}=this.props;if(e.messageStreamStatus===b.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading)return n.createElement(S.default,{className:"websocket-stream-loader"});let t;if(e.messageStreamStatus===b.WEBSOCKET_MESSAGE_STREAM_STATUS.Error?t="error":e.messageStreamStatus===b.WEBSOCKET_MESSAGE_STREAM_STATUS.Empty&&(t="empty"),t&&this.emptyState[t]){const{title:e,message:s,illustration:a,secondaryAction:i}=this.emptyState[t];return n.createElement(y.default,{className:"stream-empty-state",illustration:a,title:e,message:s,secondaryAction:i})}return n.createElement("div",{className:c()("websocket-stream",this.props.className)},n.createElement(T.default,{model:e,ref:e=>{this.toolbarRef=e}},this.props.toolbarExtras),this.renderContent())}})||a},12211:function(e,t,s){s.r(t),s.d(t,{default:function(){return O}});var a,n=s(1),i=s(2399),r=s(1039),o=s(2403),l=s.n(o),c=s(5021),d=s(4393),p=s(5052),u=s(5053),h=s(3194),m=s(5054),E=s(5043),g=s(5051),S=s(3573),y=s(2406),_=s(2448),T=s(4898),f=s(4363),b=s(2417),v=s(5463),C=s(40);const M=(0,b.default)(T.Flex).withConfig({displayName:"WebSocketMessageStreamControls__Container",componentId:"postman-app__sc-12eqnha-0"})(["display:flex;align-items:center;justify-content:center;min-height:var(--size-xs);min-width:var(--size-xs);background-color:",";"],(e=>e.background&&`var(--${e.background})`));let O=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.state={addShadow:!1,filterInput:this.props.model.messageFilter||""},this.handleHideAll=this.handleHideAll.bind(this),this.handleFilterDropdownSelect=this.handleFilterDropdownSelect.bind(this),this.handleFilterInput=this.handleFilterInput.bind(this),this.handleFilterClear=this.handleFilterClear.bind(this),this.debouncedOnFilterInput=C.debounce(this.onFilterInput.bind(this),300)}onFilterInput(e){(0,r.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.set("messageFilter",e)}))}onScroll(e){(0!==e||this.state.addShadow)&&(0!==e&&this.state.addShadow||this.setState((e=>({addShadow:!e.addShadow}))))}getClasses(){return l()({"websocket-message-stream-controls":!0,"add-shadow":this.state.addShadow})}getIcon(e){const t=v.MESSAGE_ICON_MAP[e]||!1;if(!t)return;const{name:s,color:a,size:i,backgroundColor:r}=t;return n.createElement(M,{background:r},n.createElement(y.default,{name:s,color:a,size:i}))}handleHideAll(){(0,r.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.hideAllMessages()}))}handleFilterDropdownSelect(e){(0,r.transaction)((()=>{this.props.model.flushNewMessages(),this.props.model.set("messageTypeFilter",e)}))}handleFilterInput(e){const t=C.get(e,"target.value");this.setState({filterInput:t}),this.debouncedOnFilterInput(t)}handleFilterClear(){this.setState({filterInput:""}),this.onFilterInput("")}render(){return n.createElement(T.Flex,{alignItems:"flex-start",className:this.getClasses()},n.createElement(T.Flex,{wrap:"wrap",rowGap:"spacing-s",gap:"spacing-s"},n.createElement("div",{className:"websocket-message-stream-controls__filter-input"},n.createElement(c.default,{type:"search",placeholder:"Search",value:this.state.filterInput,onChange:this.handleFilterInput,onClear:this.handleFilterClear,label:n.createElement(d.default,{text:"Search",isHidden:!0})})),n.createElement(T.Flex,null,n.createElement(p.default,null,n.createElement(u.default,{type:"tertiary",text:n.createElement(T.Flex,{gap:"spacing-xs",alignItems:"center"},this.getIcon(this.props.model.messageTypeFilter),n.createElement(h.default,null,v.MESSAGE_TYPE_FILTER_LABELS[this.props.model.messageTypeFilter]))}),n.createElement(m.default,{className:"websocket-message-stream-controls__filter-dropdown"},C.map(v.MESSAGE_TYPE_FILTER_LABELS,((e,t)=>"addSeparator"===t?n.createElement(E.default,null):n.createElement(g.default,{key:t,className:"message-type-filter-item",onClick:()=>this.handleFilterDropdownSelect(t)},this.getIcon(t),e))))),n.createElement(S.default,{type:"tertiary",icon:n.createElement(_.default,null),size:"medium",text:this.props.model.layoutName===f.REQUESTER_TAB_LAYOUT_1_COLUMN?"Clear Messages":null,tooltip:this.props.model.layoutName===f.REQUESTER_TAB_LAYOUT_1_COLUMN?null:"Clear Messages",onClick:this.handleHideAll,isDisabled:C.isEmpty(this.props.model.filteredMessages)&&this.props.model.hasMessagesToRestore}))),n.createElement("div",{className:"websocket-message-stream-controls__right-side"},this.props.children))}})||a},12210:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a,n=s(1),i=s(2399),r=s(3573),o=s(3194);let l=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleDeselect=this.handleDeselect.bind(this)}handleDeselect(){this.props.model.deselectAllMessages&&this.props.model.deselectAllMessages()}render(){return n.createElement("div",{className:"message-relational-info-toolbar"},n.createElement(r.default,{type:"muted-plain",text:"Deselect",onClick:this.handleDeselect,className:"message-relational-info-toolbar__deselect"}),n.createElement(o.default,{type:"body-medium",color:"content-color-primary"},`Time difference: ${this.props.model.timeDifference}`))}})||a},12209:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a,n=s(1),i=s(2399),r=s(12210),o=s(12211);let l=(0,i.observer)(a=class extends n.Component{onScroll(e){this.streamControlsRef&&this.streamControlsRef.onScroll(e)}render(){const{model:e}=this.props;return 2===e.selectedMessageSet.size?n.createElement(r.default,{model:e}):n.createElement(o.default,{model:e,ref:e=>{this.streamControlsRef=e}},this.props.children)}})||a},12234:function(e,t,s){s.r(t);var a=s(1),n=s(4),i=s(2403),r=s.n(i),o=s(2399),l=s(5052),c=s(5053),d=s(3573),p=s(5054),u=s(5051),h=s(3192),m=s(2486),E=s(5080),g=s(3572),S=s(3559),y=s(3562),_=s(5463),T=s(5461),f=s(40);function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},b.apply(this,arguments)}t.default=(0,o.observer)((({model:e,unCollapseEditorPane:t})=>{const s=(0,a.useRef)(new Map),i=(0,a.useRef)(new Map),o=(0,a.useRef)(null),[v,C]=(0,a.useState)(0);function M(e){const t=s.current.get(e);t&&t.startEditing()}function O(e,t){const a=s.current.get(e);t&&a&&(a.focus(),a.selectAll())}function A(t,s){e.saveMessageProperty(t,"title",s)}function N(n,o){const{eventName:h}=n.initialState,g=t=>{const s=e.messageSDK.hasPermission(n.get("id"),t);return{isDisabled:!s,tooltip:(()=>{if(!s)return y.DISABLED_TOOLTIP_NO_PERMISSION})()}};return a.createElement("div",{key:n.get("id"),onClick:()=>function(s){e.selectSavedMessage(s),t()}(n),className:r()({"websocket-saved-messages__message":!0,"websocket-saved-messages__message--selected":n===e.currentComposeMessage}),ref:e=>i.current.set(o,e)},void 0!==h&&a.createElement(T.default,{name:h,color:e.eventsCache.getColor(h)}),a.createElement("div",{className:"websocket-saved-messages__message-title",title:n.initialState.title},a.createElement(S.default,{value:n.initialState.title,onSubmit:A.bind(null,n),onToggleEdit:O.bind(null,o),ref:e=>s.current.set(o,e),placeholder:"Message Title"})),a.createElement("div",{className:"websocket-saved-messages__right-side"},a.createElement("div",{className:"websocket-saved-messages__message-menu"},a.createElement(l.default,null,a.createElement(c.default,{className:"websocket-saved-messages__more-options"},a.createElement(d.default,{icon:a.createElement(m.default,null)})),a.createElement(p.default,null,a.createElement(u.default,b({},g(E.ItemAction.RENAME),{onClick:()=>M(o)}),a.createElement("span",null,"Rename")),a.createElement(u.default,b({},g(E.ItemAction.DUPLICATE),{onClick:()=>e.duplicateSavedMessage(n)}),a.createElement("span",null,"Duplicate")),a.createElement(u.default,b({},g(E.ItemAction.DELETE),{onClick:()=>e.deleteSavedMessage(n),type:"destructive"}),a.createElement("span",null,"Delete")))))))}return(0,a.useEffect)((()=>{let t;if(e.currentComposeMessage===e.draftComposeMessage)t=o.current;else{const s=e.savedMessages.indexOf(e.currentComposeMessage);e.editTitle&&e.editTitle===e.currentComposeMessage.get("id")&&(M(s),e.editTitle=null),-1!==s&&(t=i.current.get(s))}if(t){const e=(0,n.findDOMNode)(t);e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})}}),[e.currentComposeMessage]),a.createElement("div",{className:r()({"websocket-saved-messages":!0,"websocket-saved-messages--empty":f.isEmpty(e.savedMessages)})},e.savedMessagesStatus===_.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading?a.createElement("div",{className:r()({"websocket-saved-messages":!0,"websocket-saved-messages--empty":!0})},a.createElement(h.default,{description:"Loading messages",size:"small"})):e.savedMessagesStatus===_.WEBSOCKET_MESSAGE_STREAM_STATUS.Error?a.createElement(g.default,{title:{text:"Couldnâ€™t load your messages."},message:{text:v<3?"Just a faulty wire. Please try again.":"We are unable to load your messages due to unforeseen circumstances. Please try again later."},secondaryAction:v<3?{label:"Retry",type:"outline",onClick:()=>{C(v+1),e.fetchSavedMessage()}}:null}):f.isEmpty(e.savedMessages)?a.createElement(g.default,{message:{text:"Add messages to reuse them during an active connection"}}):a.createElement(a.Fragment,null,e.savedMessages.map(((e,t)=>N(e,t)))))}))},12229:function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var a=s(1),n=s(2403),i=s.n(n);class r extends a.Component{getClasses(){return i()({"websocket-request-tab-content":!0,"is-hidden":!this.props.active},this.props.className)}render(){const e=this.getClasses();return a.createElement("div",{className:e},this.props.children)}}},12230:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var a=s(1);function n(e){const t=a.Children.map(e.children,(t=>t&&a.cloneElement(t,{active:e.activeKey===t.key})));return a.createElement("div",{className:"websocket-request-tab-contents"},t)}},12212:function(e,t,s){s.r(t);var a=s(2239),n=s(1916),i=s(2255),r=s(4470),o=s(6493),l=s(40);async function c(){return(0,r.resolveStoreInstance)(o.default).onSyncAvailable({timeout:5e3})}const d=200,p={async createHistory(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history`,body:t}});if(!s)throw new Error("WebSocketHistoryService~createHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~createHistory: Non 200 response status code",s.status);const a=l.get(s,"body.id");if(!a)throw new Error("WebSocketHistoryService~createHistory:History ID not received.");return{id:a}},async addMessagesToHistory(e,t,s){await c();const a=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/${t}/messages`,body:s}});if(!a)throw new Error("WebSocketHistoryService~addMessagesToHistory: Response not available");if(a.status!==d)throw new Error("WebSocketHistoryService~addMessagesToHistory: Non 200 response status code")},async fetchHistoryList({workspaceId:e,nextCursor:t,limit:s=50,dir:a="desc"}){let i=`?dir=${a}`;t&&(i=`${i}&cursor=${t}`),s&&(i=`${i}&limit=${s}`),await c();const r=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history${i}`}});if(!r)throw new Error("WebSocketHistoryService~fetchHistoryList: Response not available");if(r.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryList: Non 200 response status code",r.status);const{data:o,meta:p}=l.get(r,"body",{});if(!o||!p)throw new Error("WebSocketHistoryService~fetchHistoryList: Incorrect response structure.");return{data:o,meta:p}},async fetchHistoryMeta(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Non 200 response status code",s.status);return s.body},async fetchHistoryMessages(e,t){await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}/messages`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Non 200 response status code",s.status);const{messages:a}=l.get(s,"body",{});if(!a)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Incorrect response structure.");return a},async deleteHistory(e,t){l.isString(t)&&(t=[t]),await c();const s=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"delete",path:`/workspaces/${e}/history`,body:{ids:t}}});if(!s)throw new Error("WebSocketHistoryService~deleteHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~deleteHistory: Non 200 response status code",s.status)},async subscribeToRealtimeEvents(e){await c();const t=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/subscribe`}});if(!t)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Non 200 response status code",t.status);const{subscription:s}=t.body||{};return(0,i.getRealtimeMessagesObservable)().pipe((0,a.filter)((e=>e&&e.sub===s)))},async unsubscribeFromRealtimeEvents(e){await c();const t=await n.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/unsubscribe`}});if(!t)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Non 200 response status code",t.status)}};t.default=p},12247:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a=s(4621),n=s(4596),i=s(12238),r=s(5463),o=s(40);class l extends i.default{didCreate({routeParams:e}){return this.id=e&&e.echid,this.setWorkbenchStatus(n.LOADING),(0,a.getViewHistoryPermission)().then((e=>{if(!e)return this.setWorkbenchStatus(r.WORKBENCH_VIEW_PERMISSION_ERROR),Promise.resolve();const t=r.SDK_MAP[this._route.split("/")[0]];if(!t)throw new Error("Failed to extract sdk from type");return t.history.fetchHistory(this.id).then((e=>{const t=e[0],s=e.slice(1,-1);return[{...t.item,id:this.id},s]})).catch((e=>{pm.logger.error("WebSocketHistoryWorkbenchController~fetchHistory",e),this.setWorkbenchStatus(n.ERROR)}))})).then((([e,t])=>{if(e&&!o.isEmpty(t))return this.setActiveModel(e.type,e,r.WEBSOCKET_MESSAGE_STREAM_STATUS.Loading,{isHistory:!0,tabId:this.getTabId()}),this.restoreRequestState(),this.setWorkbenchStatus(n.READY),this.model.onMessageStreamFetch(null,t)}))}}},12226:function(e,t,s){s.r(t),s.d(t,{canOverridePreviewHeader:function(){return h},getPreviewHeaders:function(){return p},prepareHeadersForPreview:function(){return u}});var a=s(40);const n="connection",i="upgrade",r="host",o="sec-websocket-version",l="sec-websocket-key",c="sec-websocket-extensions",d={[r]:1,[n]:2,[i]:3,[l]:4,[o]:5,[c]:6};function p(){return{[r]:{enabled:!0,key:"Host",system:!0,value:"<calculated at runtime>"},[n]:{enabled:!0,key:"Connection",system:!0,value:"Upgrade"},[i]:{enabled:!0,key:"Upgrade",system:!0,value:"websocket"},[l]:{enabled:!0,key:"Sec-WebSocket-Key",system:!0,value:"<calculated at runtime>"},[o]:{enabled:!0,key:"Sec-WebSocket-Version",system:!0,value:"13"},[c]:{enabled:!0,key:"Sec-WebSocket-Extensions",system:!0,value:"permessage-deflate; client_max_window_bits"}}}function u(e,t={}){return a.map(e,(e=>{if(!e)return;const s=a.toLower(e.key);let p={};switch(s){case o:p={header:"This header was automatically added",body:"The Sec-WebSocket-Version header field is used in the WebSocket opening handshake. It is sent from the client to the server to indicate the protocol version of the connection. This enables servers to correctly interpret the opening handshake and subsequent data being sent from the data, and close the connection if the server cannot interpret that data in a safe manner."};break;case l:p={header:"This header was automatically added",body:"The Sec-WebSocket-Key header field is used in the WebSocket opening handshake. It is sent from the client to the server to provide part of the information used by the server to prove that it received a valid WebSocket opening handshake. This helps ensure that the server does not accept connections from non-WebSocket clients (e.g., HTTP clients) that are being abused to send data to unsuspecting WebSocket servers."};break;case c:p={header:"This header was automatically added",body:"The Sec-WebSocket-Extensions header field is used in the WebSocket opening handshake. It is initially sent from the client to the server, and then subsequently sent from the server to the client, to agree on a set of protocol-level extensions to use for the duration of the connection."};break;case i:p={header:"This header was automatically added",body:"The WebSocket handshake uses the HTTP Upgrade header to change from the HTTP protocol to the WebSocket protocol."};break;case r:p={header:"This header was automatically added",body:"The Host request-header field specifies the Internet host and port number of the resource being requested, as obtained from the original URI."};break;case n:p={header:"This header was automatically added",body:"The Connection general-header field allows the sender to specify options that are desired for that particular connection."}}return a.assign({previewInfoTooltip:p,disableEdit:!0,sortOrder:d[s],warning:t[s],overridden:a.has(t,s)},e,{enableSettingToTurnOffPreviewEntity:!1,previewEntityWithHelper:null})}))}function h(e,t){if(!t)return null;return a.toLower(t)!==c}},12243:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var a=s(1039),n=s(1603),i=s.n(n),r=s(2219),o=s(1882),l=s(6568),c=s(5507),d=s(5464),p=s(12242),u=s(12239),h=s(4503),m=s(5463),E=s(5503),g=s(12244),S=s(40),y=s(189).Buffer;class _ extends u.default{constructor(e,t,s){super(m.WEBSOCKET_REQUEST_TYPE.RAW,e,t,s),this.type=m.WEBSOCKET_REQUEST_TYPE.RAW,this.messageParser={...this.messageParser,[m.WEBSOCKET_OUTGOING_MESSAGE]:g.parseIncomingOrOutgoingMessage,[m.WEBSOCKET_INCOMING_MESSAGE]:g.parseIncomingOrOutgoingMessage},this.historyEventParser={...this.historyEventParser,"sent-message":g.parseSentOrReceviedMessageEvent,"received-message":g.parseSentOrReceviedMessageEvent}}async saveMessageFromStream(e){let t;const s=S.get(e,"meta.preview.text"),a="string"==typeof s&&S.trim(s.substring(0,50))||"New message";t=ArrayBuffer.isView(e.payload)?new h.ObservableTrackedState(new p.RawComposeMessage({title:a,content:y.from(e.payload).toString("base64"),type:d.WebSocketMessageBodyType.BINARY,subtype:d.WebSocketMessageBodySubType.BASE64})):new h.ObservableTrackedState(new p.RawComposeMessage({title:a,content:e.payload,type:m.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[e.meta.mimeType]||d.WebSocketMessageBodyType.TEXT,subtype:null})),await this.saveMessage(t,!0)}_serializeSavedMessage(e){const t={...S.pick(e,["id","title"]),type:E.default.type,payload:S.pick(e,["content","type"])};return e.type===d.WebSocketMessageBodyType.POSTMAN_JSON&&(t.payload.type=d.WebSocketMessageBodyType.JSON),e.type===d.WebSocketMessageBodyType.BINARY&&(t.payload.subtype=e.subtype),t}_deserializeSavedMessage(e){const t={...S.pick(e,["id","title"]),...S.pick(e.payload,["content","type","subtype"])};return t.type===d.WebSocketMessageBodyType.JSON&&(t.type=d.WebSocketMessageBodyType.POSTMAN_JSON),t}async connectionSetup(){super.connectionSetup();try{this.handshakeConfiguration=await(0,c.prepareHandshakeConfiguration)({url:this.url,settings:(0,a.toJS)(this.settings),headers:(0,a.toJS)(this.headers)},{collection:this.collection})}catch(e){pm.logger.error("RawWebSocketWorkbenchModel~connectionSetup: Error in preparing handshake config",e)}}onOpen({request:e,response:t,meta:{protocol:s,extensions:n}={},time:i}){(0,a.transaction)((()=>{this.set("status",m.CONNECTED),this.set("connectionStatistics",{connectedOn:i,protocol:s,extensions:n});const a=(0,c.createMessage)(m.WEBSOCKET_CONNECTED_MESSAGE,{handshakeDetails:(0,c.prepareHandshakeDetails)(e,t)},{preview:(0,c.getMessagePreview)(m.WEBSOCKET_CONNECTED_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:i,mimeType:m.APPLICATION_JSON});this.set("message",a)})),o.default.addEventV2({category:"history",action:"create",label:"websocket_connect_success",value:1,meta:{id:this.id,origin:(()=>this.isSavedRequest?"saved":S.get(this.context,"isHistory")?"history":"unsaved")()}})}onUpgrade({request:e,response:t}){(e||t)&&(t.code=`${t.statusCode} ${t.statusMessage}`,l.default.logRequest({request:e,response:t,history:{execution:{data:[{request:e,response:t}]}}}))}onMessage({message:e,meta:t,time:s}){e&&e instanceof ArrayBuffer&&(e=new Uint8Array(e));const a=(0,c.createMessage)(m.WEBSOCKET_INCOMING_MESSAGE,e,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_INCOMING_MESSAGE,{message:e,mimeType:t.mimeType}),time:s,size:t.size,mimeType:t.mimeType,fileExtension:t.ext});this.set("message",a)}onReconnect({time:e}){(0,a.transaction)((()=>{this.set("status",m.RECONNECTING);const t=(0,c.createMessage)(m.WEBSOCKET_RECONNECTING_MESSAGE,null,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_RECONNECTING_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:e,mimeType:m.TEXT_PLAIN});this.set("message",t)}))}onEnd({code:e,reason:t,aborted:s,time:n}){(0,a.transaction)((()=>{let a;this.set("status",m.IDLE),s?a=(0,c.createMessage)(m.WEBSOCKET_ABORT_MESSAGE,null,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_ABORT_MESSAGE),time:n,mimeType:m.TEXT_PLAIN}):this.handshakeError||(a=(0,c.createMessage)(m.WEBSOCKET_DISCONNECTED_MESSAGE,(0,c.getConnectionCloseInfo)(e,t),{preview:(0,c.getMessagePreview)(m.WEBSOCKET_DISCONNECTED_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:n,mimeType:m.TEXT_PLAIN})),a&&this.set("message",a)})),this.createHistory(),this.connectionCleanup()}onError({error:e,request:t,response:s,time:n}){const i=e&&(e.data||e.message)||"Socket connection error. Please try again.",r=(0,c.createMessage)(m.WEBSOCKET_ERROR_MESSAGE,{error:i,handshakeDetails:(0,c.prepareHandshakeDetails)(t,s)},{preview:(0,c.getMessagePreview)(m.WEBSOCKET_ERROR_MESSAGE,{url:S.get(this.handshakeConfiguration,"url")}),time:n,mimeType:m.APPLICATION_JSON});(0,a.transaction)((()=>{this.set("message",r),this.toggleExpanded(r.id)})),o.default.addEventV2({category:"history",action:"create",label:"websocket_connect_failure",value:1,meta:{errorCode:e&&e.code||"ERR_WEBSOCKET_UNKNOWN"}}),this.handshakeError=!0}_handleEvents(e){if(!e||e.connectionId!==this.connectionId)return;const{event:t,data:s}=e,a=m.CONNECTION_EVENT_TO_HANDLER_MAP[t];a&&S.isFunction(this[a])&&(s.time=(new Date).toISOString(),this[a](s))}attachConnectionEventsListener(){pm.runtime.agent.on("ws-events",this._handleEvents.bind(this))}async connect(){this.url&&(await this.connectionSetup(),this.set("status",m.CONNECTING),pm.runtime.wsConnect(this.connectionId,this.handshakeConfiguration),r.default.promoteEditor({id:S.get(this.context,"tabId")}))}async send(){this.connectionId||this.status!==m.IDLE||(this.connect(),await new Promise((e=>{if(this.status===m.CONNECTED)return e();this.reactionDisposer=(0,a.reaction)((()=>this.status),(t=>{t===m.CONNECTED&&(this.reactionDisposer&&this.reactionDisposer(),e())}))})));const e=this.currentComposeMessage.get("type"),t=this.currentComposeMessage.get("subtype");let s=this.currentComposeMessage.get("content");try{s=await(0,c.resolveVariables)(s,this.collection)}catch(e){pm.logger.error("WebSocketWorkbenchModel~publish: Error in resolving payload",e)}if(e===d.WebSocketMessageBodyType.POSTMAN_JSON)s=i()(s,{whitespace:!1});else if(e===d.WebSocketMessageBodyType.BINARY)try{s=(0,c.parseBinaryMessage)(s,t)}catch(e){if(e instanceof SyntaxError)return void pm.toasts.error(`Can not send message: ${e.message}.`,{dedupeId:"raw-ws-send"});throw e}const n=ArrayBuffer.isView(s)?(0,c.binaryToBase64)(s):s,r=y.byteLength(s),o=m.MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP[e];pm.runtime.wsSend(this.connectionId,n,{messageType:e},(()=>{const e=(0,c.createMessage)(m.WEBSOCKET_OUTGOING_MESSAGE,s,{preview:(0,c.getMessagePreview)(m.WEBSOCKET_OUTGOING_MESSAGE,{message:s,mimeType:o}),time:(new Date).toISOString(),size:r,mimeType:o});this.set("message",e)}))}disconnect(e=!1){this.connectionId&&(this.set("status",m.DISCONNECTING),pm.runtime.wsDisconnect(this.connectionId),e&&this.onEnd({code:1006}))}_deserializeMessages(e){return(0,c.deserializeMessages)(this.url,e)}}_.editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}}},_.MessageClass=p.RawComposeMessage,_.keysForFilterByType=["type"],_.keysForFilterByKeyword=["payload","meta.preview"]},12231:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a,n=s(1),i=s(2399),r=s(2394),o=s.n(r),l=s(3573),c=s(3267),d=s(3184),p=s(4898),u=s(3594),h=s(5154),m=s(12217),E=s(5463),g=s(5507),S=s(5464),y=s(40);const _={[S.WebSocketMessageBodyType.TEXT]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodyType.TEXT],[S.WebSocketMessageBodyType.POSTMAN_JSON]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodyType.POSTMAN_JSON],[S.WebSocketMessageBodyType.XML]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodyType.XML],[S.WebSocketMessageBodyType.HTML]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodyType.HTML],[S.WebSocketMessageBodyType.BINARY]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodyType.BINARY]},T={[S.WebSocketMessageBodySubType.BASE64]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodySubType.BASE64],[S.WebSocketMessageBodySubType.HEX]:E.USER_FRIENDLY_LANGUAGE_NAME[S.WebSocketMessageBodySubType.HEX]},f=[S.WebSocketMessageBodyType.TEXT,S.WebSocketMessageBodyType.BINARY],b={submit:"mod+enter"};let v=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.handleBeautify=this.handleBeautify.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleSubTypeChange=this.handleSubTypeChange.bind(this),this.handleMessageChange=this.handleMessageChange.bind(this),this.handleSend=this.handleSend.bind(this)}getKeyMapHandlers(){return{submit:this.handleSend}}showMessageSubTypes(e){return e===S.WebSocketMessageBodyType.BINARY}handleTypeChange(e,t){const s={type:e};this.showMessageSubTypes(e)?null==t&&y.assign(s,{subtype:S.WebSocketMessageBodySubType.BASE64}):y.assign(s,{subtype:null}),this.props.model.currentComposeMessage.set(s)}handleSubTypeChange(e){this.props.model.currentComposeMessage.set({subtype:e})}handleMessageChange(e){this.props.model.currentComposeMessage.set({content:e})}handleBeautify(){this.editorRef&&this.editorRef.beautifyContent&&this.editorRef.beautifyContent()}handleSend(){this.isSendDisabled||this.props.model.send&&this.props.model.send()}render(){let e;const{model:t}=this.props,{isDisabled:s,reason:a}=(0,g.isConnectDisabled)(t.type,t.url),i=t.currentComposeMessage.get("content"),r=t.currentComposeMessage.get("type"),o=t.currentComposeMessage.get("subtype");this.isSendDisabled=s&&(e=a)||t.status!==E.CONNECTED&&t.status!==E.IDLE;const S="OSX"===pm.app.get("platform"),v=e||(S?"âŒ˜ â†µ":"Ctrl + Enter"),C=this.showMessageSubTypes(r);return n.createElement("div",{className:"raw-websocket-compose"},n.createElement(d.default,{keyMap:b,handlers:this.getKeyMapHandlers()},n.createElement("div",{className:"raw-websocket-compose__editor","data-testid":"raw-websocket-compose-editor"},n.createElement(u.default,{fontSize:12,placeholder:"Compose message",onChange:this.handleMessageChange,language:C?o:r,value:i,ref:e=>{this.editorRef=e},codeCompletionProviders:[{provider:h.default.bind(this)}]}))),n.createElement("div",{className:"raw-websocket-compose__footer"},n.createElement("div",{className:"raw-websocket-compose__footer__left"},n.createElement(m.default,{languageMap:_,activeLanguage:r,onChange:e=>this.handleTypeChange(e,o),className:"raw-websocket-compose__footer__left__lang-selector"}),C&&n.createElement(m.default,{languageMap:T,activeLanguage:o,onChange:this.handleSubTypeChange}),!y.includes(f,r)&&n.createElement(l.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify"})),n.createElement(c.default,{alignItems:"center",wrap:"wrap",gap:"spacing-s"},n.createElement(p.Button,{variant:t.status===E.CONNECTED?"cta":"secondary",tooltip:v,onClick:this.handleSend,isDisabled:this.isSendDisabled,"data-testid":"ws-raw-sendMessage-button"},"Send"))))}})||a;v.contextTypes={variablesCache:o().object}},12206:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a=s(1),n=s(5080),i=s(12207),r=s(12215),o=s(40);class l extends a.Component{constructor(e){super(e),this.getListItem=this.getListItem.bind(this),this.handleMessageSelect=this.handleMessageSelect.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.handleListItemExpandAndCollapse=this.handleListItemExpandAndCollapse.bind(this)}getListItem(e,t){const{model:s}=this.props;return a.createElement(r.default,{key:t.id,index:e,message:t,isSelected:s.selectedMessageSet.get(t.id),numberOfSelectedMessages:s.selectedMessageSet.size,cachedExpandedState:s.expandedMessageSet.get(t.id),mediaFilePath:s.messageMediaFilePaths.get(t.id),onMediaSave:this.handleMediaSave,toggleExpanded:this.handleListItemExpandAndCollapse,toggleMessageSelect:this.handleMessageSelect,saveMessage:s.saveMessageFromStream.bind(s),saveMessagesChecks:{isSavedRequest:s.isSavedRequest,isOnline:s.messageSDK.isOnline(),hasPermission:s.messageSDK.hasPermission(null,n.ItemAction.CREATE,!1,s.id)}})}handleMediaSave(e,t){this.props.model.saveMediaFilePath(e,t)}handleListItemExpandAndCollapse(e,t,s){this.props.model.toggleExpanded&&this.props.model.toggleExpanded(t,s),o.isNil(s)&&this.streamRef&&this.streamRef.handleResetHeight(e)}handleMessageSelect(e){this.props.model&&this.props.model.toggleMessageSelect(e)}render(){return a.createElement(i.default,{ref:e=>{this.streamRef=e},model:this.props.model,renderListItem:this.getListItem})}}},12215:function(e,t,s){s.r(t),s.d(t,{default:function(){return A}});var a,n=s(1),i=s(3583),r=s.n(i),o=s(2399),l=s(1039),c=s(2403),d=s.n(c),p=s(3194),u=s(3570),h=s(3573),m=s(3202),E=s(4389),g=s(2406),S=s(1920),y=s(3584),_=s(4495),T=s(3590),f=s(3562),b=s(5507),v=s(5463),C=s(12216),M=s(5464),O=s(40);let A=(0,o.observer)(a=class extends n.Component{constructor(e){super(e),this.state={isHovered:!1,forceEllipsifyPreview:!1},this.handleCopy=this.handleCopy.bind(this),this.handleSave=this.handleSave.bind(this),this.toggleSelect=this.toggleSelect.bind(this),this.toggleExpanded=this.toggleExpanded.bind(this),this.stopItemExpand=this.stopItemExpand.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.updateExpandedCachedState=this.updateExpandedCachedState.bind(this),this.isPayloadEmpty=this.isPayloadEmpty.bind(this)}componentDidMount(){this.shouldForceEllipsifyPreview()}getClasses(e){return d()({"websocket-stream-item":!0,"server-message":e===v.WEBSOCKET_INCOMING_MESSAGE,"client-message":e===v.WEBSOCKET_OUTGOING_MESSAGE,"no-body":this.isPayloadEmpty()})}getDataTestId(e){switch(e){case v.WEBSOCKET_INCOMING_MESSAGE:return"ws-raw-server-message";case v.WEBSOCKET_OUTGOING_MESSAGE:return"ws-raw-client-message"}}getPreviewMessageClasses(){return d()({"websocket-stream-item__header__left-section__message":!0,"add-ellipsis":this.state.forceEllipsifyPreview})}isPayloadEmpty(){return O.isNil(O.get(this.props.message,"payload"))}shouldForceEllipsifyPreview(){const e=this.previewRef;!O.get(this.props.message,"meta.preview.truncated")||!e||e.clientWidth<e.scrollWidth||this.setState({forceEllipsifyPreview:!0})}showCheckBox(e){return(e===v.WEBSOCKET_OUTGOING_MESSAGE||e===v.WEBSOCKET_INCOMING_MESSAGE)&&(this.state.isHovered||this.props.isSelected||this.props.numberOfSelectedMessages>0)}stopItemExpand(e){e&&e.stopPropagation()}toggleExpanded(){if(this.isPayloadEmpty())return;const{id:e}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,e,null)}updateExpandedCachedState(e){if(this.isPayloadEmpty())return;const{id:t}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,t,e)}toggleSelect(){const{id:e}=this.props.message||{};this.props.toggleMessageSelect&&this.props.toggleMessageSelect(e)}handleMediaSave(e){this.props.onMediaSave&&this.props.onMediaSave(this.props.message.id,e)}handleCopy(){const e=O.get(this.props.message,"payload");y.default.copy(e),pm.toasts.success("Copied to clipboard",{dedupeId:"message-copied-message"})}handleSave(){this.props.saveMessage&&(this.props.saveMessage((0,l.toJS)(this.props.message)),pm.toasts.success("Message saved",{dedupeId:"message-saved-message"}))}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){this.setState({isHovered:!1})}renderObjectInspector({error:e,handshakeDetails:t}){return n.createElement("div",{className:d()({"websocket-stream-item__body__obj-inspector":!0,"no-details":O.isNil(t)})},e&&n.createElement("div",{className:"websocket-stream-item__body__obj-inspector__error"},n.createElement(p.default,{type:"strong"},"Error:"),n.createElement("span",null," "),n.createElement(p.default,{type:"body-medium",color:"content-color-primary"},e)),t&&n.createElement(n.Fragment,null,n.createElement(u.default,{type:"h6",text:"Handshake Details",color:"content-color-secondary"}),n.createElement(T.default,{data:t})))}renderText(e){const{code:t,name:s,description:a}=e||{};return n.createElement("div",{className:"websocket-stream-item__body__plain-text",title:a},n.createElement(p.default,{type:"strong"},`${t} ${s}:`),n.createElement("span",null," "),n.createElement(p.default,{type:"body-medium",color:"content-color-secondary",className:"websocket-stream-item__body__plain-text__description"},a))}renderBody(){const{type:e,meta:t,payload:s}=this.props.message||{};if(this.isPayloadEmpty())return null;let a;switch(e){case v.WEBSOCKET_OUTGOING_MESSAGE:case v.WEBSOCKET_INCOMING_MESSAGE:{const e=v.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[t.mimeType],i={activeLanguage:e||M.WebSocketMessageBodyType.TEXT,lineWrap:!1,hexMode:!1};e===M.WebSocketMessageBodyType.HEXDUMP&&O.assign(i,{activeLanguage:null,hexMode:!0}),a=n.createElement("div",{className:"websocket-stream-item__body__message-body-viewer"},n.createElement(C.default,{message:s,mimeType:t.mimeType,mediaFilePath:this.props.mediaFilePath,fileExtension:t.fileExtension,onMediaSave:this.handleMediaSave,cachedState:O.assign(i,this.props.cachedExpandedState),updateState:this.updateExpandedCachedState}));break}case v.WEBSOCKET_CONNECTED_MESSAGE:case v.WEBSOCKET_ERROR_MESSAGE:a=this.renderObjectInspector(s);break;case v.WEBSOCKET_DISCONNECTED_MESSAGE:default:a=this.renderText(s)}return n.createElement("div",{className:"websocket-stream-item__body"},a)}renderHeaderRightSection(e,t={},s){const{time:a,size:i,mimeType:o}=t,l=r()(a).format("HH:mm:ss"),{isSavedRequest:c,hasPermission:d}=this.props.saveMessagesChecks||{},u=this.isPayloadEmpty()?null:n.createElement(g.default,{name:this.props.cachedExpandedState?"icon-direction-up":"icon-direction-down",color:"content-color-primary",size:"large"});let E=null;const y=l?n.createElement("div",{className:"websocket-stream-item__header__right-section__time"},n.createElement(p.default,{type:"body-medium",color:"content-color-secondary"},l)):null;if(!this.state.isHovered||e!==v.WEBSOCKET_OUTGOING_MESSAGE&&e!==v.WEBSOCKET_INCOMING_MESSAGE)E=y;else{const e=!v.WEBSOCKET_MESSAGE_READABLE.has(o)||this.isPayloadEmpty()||!s;E=n.createElement(n.Fragment,null,n.createElement("div",{className:"websocket-stream-item__header__right-section__quick-actions",onClick:this.stopItemExpand},n.createElement(h.default,{onClick:this.handleCopy,type:"tertiary",icon:"icon-action-copy-stroke",isDisabled:e,tooltip:n.createElement(m.default,{content:e?"Can't copy this message":"Copy message",placement:"bottom"})}),n.createElement(h.default,{onClick:this.handleSave,type:"tertiary",icon:"icon-action-save-stroke",isDisabled:!d||!c,tooltip:n.createElement(m.default,{content:c?d?"Save message":f.DISABLED_TOOLTIP_NO_PERMISSION:"Save this request to perform this action.",placement:"bottom"})}),n.createElement(_.default,{tooltipPlacement:"bottom-left",iconSize:"large",tooltip:n.createElement("div",{className:"websocket-stream-info-tooltip"},n.createElement(p.default,{type:"body-medium",color:"content-color-primary"},`Size: ${S.default.formatSize(i)}`),n.createElement(p.default,{type:"body-medium",color:"content-color-primary"},`Time: ${l}`),n.createElement(p.default,{type:"body-medium",color:"content-color-primary"},`MIME Type: ${o}`))})),y)}return n.createElement("div",{className:"websocket-stream-item__header__right-section"},E,u)}renderHeader(){const{type:e,meta:t,payload:s}=this.props.message||{},a=v.MESSAGE_ICON_MAP[e]||v.MESSAGE_ICON_MAP.default||{},i=O.isFunction(a)?a((0,b.isNormalConnectionClose)(O.get(s,"code"))):a,{name:r,color:o,size:l}=i||{};let c;return t&&(c=O.isString(t.preview)?t.preview:O.get(t.preview,"text")),n.createElement("div",{className:d()({"websocket-stream-item__header":!0,"is-hovered":this.state.isHovered,"is-selected":this.props.isSelected}),onClick:this.toggleExpanded,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n.createElement("div",{className:"websocket-stream-item__header__left-section",ref:e=>{this.previewRef=e}},this.showCheckBox(e)&&n.createElement("div",{className:"websocket-stream-item__header__left-section__checkbox",onClick:this.stopItemExpand},n.createElement(E.default,{isChecked:this.props.isSelected,onChange:this.toggleSelect,isDisabled:!this.props.isSelected&&2===this.props.numberOfSelectedMessages})),r&&o&&n.createElement("div",{className:"websocket-stream-item__header__left-section__type-icon"},n.createElement(g.default,{name:r,color:o,size:l})),n.createElement(p.default,{type:"body-medium",className:this.getPreviewMessageClasses(e),color:t.preview.placeholder?"content-color-secondary":"content-color-primary"},c)),this.renderHeaderRightSection(e,t,s))}render(){const{type:e}=this.props.message||{};return n.createElement("div",{className:this.getClasses(e),"data-testid":this.getDataTestId(e)},this.renderHeader(),Boolean(this.props.cachedExpandedState)&&this.renderBody())}})||a},12241:function(e,t,s){s.r(t),s.d(t,{default:function(){return N}});var a,n,i,r,o=s(37),l=s.n(o),c=s(1039),d=s(1603),p=s.n(d),u=s(2219),h=s(1882),m=s(5464),E=s(5507),g=s(5462),S=s(5463),y=s(12239),_=s(12242),T=s(4503),f=s(5508),b=s(5506),v=s(40),C=s(189).Buffer;function M(e,t,s,a,n){var i={};return Object.keys(a).forEach((function(e){i[e]=a[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,a){return a(e,t,s)||s}),i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}const O=/^#[a-fA-F0-9]{6}$/;let A=(n=M((a=class{constructor(){var e,t,s,a;e=this,t="eventColorMap",a=this,(s=n)&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(a):void 0})}populate(e){v.forEach(e,(({eventName:e,eventColor:t})=>{var s;s=t,O.test(s)?this.eventColorMap.set(e,t):this.getColor(e)}))}has(e){return this.eventColorMap.has(e)}setColor(e,t){if(!e||!t)return pm.logger.error("EventsCache~setColor: Event name and color are mandatory parameters");this.eventColorMap.set(e,t)}getColor(e){if(!v.isNil(e))return this.has(e)||this.setColor(e,f.EVENT_COLOR_CODE_SET[this.eventColorMap.size%f.EVENT_COLOR_CODE_SET.length]),this.eventColorMap.get(e)}get events(){return[...this.eventColorMap.keys()]}}).prototype,"eventColorMap",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.observable.map([])}}),M(a.prototype,"populate",[c.action],Object.getOwnPropertyDescriptor(a.prototype,"populate"),a.prototype),M(a.prototype,"setColor",[c.action],Object.getOwnPropertyDescriptor(a.prototype,"setColor"),a.prototype),a);let N=((r=class extends y.default{constructor(e,t,s){super(S.WEBSOCKET_REQUEST_TYPE.SOCKETIO,e,t,s),this.type=S.WEBSOCKET_REQUEST_TYPE.SOCKETIO,this.eventsCache=new A,this.historyEventToMessageType={...this.historyEventToMessageType,"subscribe-event":f.SOCKETIO_SUBSCRIBED_MESSAGE,"unsubscribe-even":f.SOCKETIO_UNSUBSCRIBED_MESSAGE},this.messageToHistoryEventType={...this.messageToHistoryEventType,[f.SOCKETIO_SUBSCRIBED_MESSAGE]:"subscribe-event",[f.SOCKETIO_UNSUBSCRIBED_MESSAGE]:"unsubscribe-event"},this.messageParser={...this.messageParser,[S.WEBSOCKET_OUTGOING_MESSAGE]:g.parseIncomingOrOutgoingMessage,[S.WEBSOCKET_INCOMING_MESSAGE]:g.parseIncomingOrOutgoingMessage,[f.SOCKETIO_SUBSCRIBED_MESSAGE]:g.parseSubscribedOrUnsubscribedMessage,[f.SOCKETIO_UNSUBSCRIBED_MESSAGE]:g.parseSubscribedOrUnsubscribedMessage},this.historyEventParser={...this.historyEventParser,"sent-message":g.parseSentOrReceviedMessageEvent,"received-message":g.parseSentOrReceviedMessageEvent,"subscribe-event":g.parseSubscribedOrUnsubscribedEvent,"unsubscribe-event":g.parseSubscribedOrUnsubscribedEvent}}set events(e){this._trackedRequest.set({events:e})}get events(){return this._trackedRequest.get("events")}getRequestForView(e){const t=super.getRequestForView(e);if(this.context.isHistory){const s=v.get(e,"channels");v.isArray(s)&&(t.events=s)}return t}getRequestForStorage(){const e=super.getRequestForStorage();return v.merge(e,{payload:{events:(0,c.toJS)(this.events,{recurseEverything:!0})}})}addArgument(e){const t=this.currentComposeMessage.get("args"),s=t.length;this.currentComposeMessage.set({args:t.concat(new _.WebSocketComposeMessage)}),v.isFunction(e)&&e(s)}updateArgument(e,t){const s=this.currentComposeMessage.get("args").slice();s[e]&&(s[e]=new _.WebSocketComposeMessage({...s[e],...t}),this.currentComposeMessage.set({args:s}))}deleteArgument(e){const t=this.currentComposeMessage.get("args").slice();!t[e]||t.length<2||(t.splice(e,1),this.currentComposeMessage.set({args:t}))}toggleAcknowledgement(){const e=!this.currentComposeMessage.get("acknowledgement");this.currentComposeMessage.set({acknowledgement:e})}updateEventName(e){this.currentComposeMessage.set({eventName:e})}async saveMessageFromStream(e){const t=v.get(e,"meta.preview.text"),s="string"==typeof t&&v.trim(t.substring(0,50))||"New message",a=new T.ObservableTrackedState(new _.SocketIOComposeMessage({title:s,eventName:e.meta.eventName,acknowledgement:!1,args:e.payload.map((e=>ArrayBuffer.isView(e.value)?{content:C.from(e.value).toString("base64"),type:m.WebSocketMessageBodyType.BINARY,subtype:m.WebSocketMessageBodySubType.BASE64}:{content:e.value,type:S.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[e.meta.mimeType]||m.WebSocketMessageBodyType.TEXT,subtype:null}))}));await this.saveMessage(a,!0)}_serializeSavedMessage(e){const t={...v.pick(e,["id","title"]),type:b.default.type,payload:v.pick(e,["eventName","acknowledgement"])};return t.payload.args=v.map(e.args,(({content:e,type:t,subtype:s})=>{const a={content:e,type:t};return a.type===m.WebSocketMessageBodyType.POSTMAN_JSON&&(a.type=m.WebSocketMessageBodyType.JSON),a.type===m.WebSocketMessageBodyType.BINARY&&(a.subtype=s),a})),t}_deserializeSavedMessage(e){const t={...v.pick(e,["id","title"]),...v.pick(e.payload,["eventName","acknowledgement"])};return t.args=v.map(v.get(e,"payload.args"),(({content:e,type:t,subtype:s})=>{const a={content:e,type:t,subtype:s};return a.type===m.WebSocketMessageBodyType.JSON&&(a.type=m.WebSocketMessageBodyType.POSTMAN_JSON),a})),t}saveMediaFilePath(e,t,s){if(!e||!t)return;const a=this.messageMediaFilePaths.get(e)||{};v.isNil(a)?this.messageMediaFilePaths.set(e,{[t]:s}):this.messageMediaFilePaths.set(e,v.assign(a,{[t]:s}))}toggleExpanded(e,t){if(!this.expandedMessageSet.has(e))return this.expandedMessageSet.set(e,{});if(v.isNil(t))return this.expandedMessageSet.delete(e);const s=this.expandedMessageSet.get(e);v.assign(s,t)}get activeEventsCount(){return(0,g.sanitizeEvents)(this.events).length}onConnect({request:e,response:t,time:s}){(0,c.transaction)((()=>{this.set("status",S.CONNECTED),this.set("connectionStatistics",{connectedOn:s}),this.set("message",{id:l()(),type:S.WEBSOCKET_CONNECTED_MESSAGE,payload:{handshakeDetails:(0,E.prepareHandshakeDetails)(e,t)},meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_CONNECTED_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:s,mimeType:S.APPLICATION_JSON}});const a=this.handshakeConfiguration.listeners;a.forEach((e=>{const t={id:l()(),type:f.SOCKETIO_SUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,E.getMessagePreview)(f.SOCKETIO_SUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:S.TEXT_PLAIN}};this.set("message",t)})),0===a.length&&this.set("message",{id:l()(),type:f.SOCKETIO_NO_LISTENER_MESSAGE,removeFromHistory:!0,meta:{preview:(0,E.getMessagePreview)(f.SOCKETIO_NO_LISTENER_MESSAGE),time:(new Date).toISOString()}})})),h.default.addEventV2({category:"history",action:"create",label:"socketio_connect_success",value:1,meta:{id:this.id,eventsCount:v.size(this.events),origin:(()=>this.isSavedRequest?"saved":v.get(this.context,"isHistory")?"history":"unsaved")()}})}onMessage({message:e,meta:t,time:s}){const a=v.map(e,(({value:e,mimeType:t,ext:s},a)=>({id:l()(),value:e instanceof ArrayBuffer?new Uint8Array(e):e,name:(0,g.getArgName)(a),meta:{mimeType:t,fileExtension:s}})));(0,c.transaction)((()=>{const e={id:l()(),type:S.WEBSOCKET_INCOMING_MESSAGE,payload:a,meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_INCOMING_MESSAGE,{message:v.get(a,[0,"value"]),mimeType:v.get(a,[0,"meta","mimeType"])}),time:s,eventName:t.event}};this.set("message",e)}))}onError({request:e,response:t,error:s,time:a}){const n=s&&(s.data||s.message)||"Socket connection error. Please try again.",i={id:l()(),type:S.WEBSOCKET_ERROR_MESSAGE,payload:{error:n,handshakeDetails:(0,E.prepareHandshakeDetails)(e,t)},meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_ERROR_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:a,mimeType:S.APPLICATION_JSON}};(0,c.transaction)((()=>{this.set("message",i),this.toggleExpanded(i.id)})),h.default.addEventV2({category:"history",action:"create",label:"socketio_connect_failure",value:1,meta:{errorMessage:n}}),this.handshakeError=!0}onReconnect({time:e}){(0,c.transaction)((()=>{this.set("status",S.RECONNECTING),this.set("message",{id:l()(),type:S.WEBSOCKET_RECONNECTING_MESSAGE,meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_RECONNECTING_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:e,mimeType:S.TEXT_PLAIN}})}))}onEnd({reason:e,aborted:t,time:s}){(0,c.transaction)((()=>{let a;this.set("status",S.IDLE),t?a={id:l()(),type:S.WEBSOCKET_ABORT_MESSAGE,payload:null,meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_ABORT_MESSAGE),time:s,mimeType:S.TEXT_PLAIN}}:this.handshakeError||(a={id:l()(),type:S.WEBSOCKET_DISCONNECTED_MESSAGE,payload:(0,g.getConnectionCloseInfo)(e),meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_DISCONNECTED_MESSAGE,{url:v.get(this.handshakeConfiguration,"url")}),time:s,mimeType:S.TEXT_PLAIN}}),a&&this.set("message",a)})),this.createHistory(),this.connectionCleanup()}_handleEvents(e){if(!e||e.connectionId!==this.connectionId)return;const{event:t,data:s}=e,a=f.CONNECTION_EVENT_TO_HANDLER_MAP[t];a&&v.isFunction(this[a])&&(s.time=(new Date).toISOString(),this[a](s))}attachConnectionEventsListener(){pm.runtime.agent.on("socketIO-events",this._handleEvents.bind(this))}async connectionSetup(){super.connectionSetup();try{this.handshakeConfiguration=await(0,g.prepareHandshakeConfiguration)({url:this.url,settings:(0,c.toJS)(this.settings),headers:(0,c.toJS)(this.headers),listeners:this.events},{collection:this.collection})}catch(e){pm.logger.error("SocketIOWorkbenchModel~connectionSetup: Error in preparing handshake config",e)}}async connect(){this.url&&(await this.connectionSetup(),this.set("status",S.CONNECTING),pm.runtime.socketIOConnect(this.connectionId,this.handshakeConfiguration),u.default.promoteEditor({id:v.get(this.context,"tabId")}))}async publish(){this.connectionId||this.status!==S.IDLE||(this.connect(),await new Promise((e=>{if(this.status===S.CONNECTED)return e();this.reactionDisposer=(0,c.reaction)((()=>this.status),(t=>{t===S.CONNECTED&&(this.reactionDisposer&&this.reactionDisposer(),e())}))})));let e=v.cloneDeep(this.currentComposeMessage.get("args"));try{e=await(0,E.resolveVariables)(e,this.collection)}catch(e){pm.logger.error("SocketIOWorkbenchModel~publish: Error in resolving payload",e)}for(let t=0;t<e.length;t++){const s=e[t];if(s.type===m.WebSocketMessageBodyType.POSTMAN_JSON){s.content=p()(s.content,{whitespace:!1});try{JSON.parse(s.content)}catch(e){return void pm.toasts.error("Can not send message: Invalid JSON.",{dedupeId:"socketIO-publish"})}}else if(s.type===m.WebSocketMessageBodyType.BINARY)try{s.content=(0,E.parseBinaryMessage)(s.content,s.subtype)}catch(e){if(e instanceof SyntaxError)return void pm.toasts.error(`Can not send message: ${e.message}.`,{dedupeId:"socketIO-send"});throw e}s.mimeType=S.MESSAGE_BODY_TYPE_TO_MIME_TYPE_MAP[s.type]}const t=v.map(e,(e=>({value:ArrayBuffer.isView(e.content)?(0,E.binaryToBase64)(e.content):e.content,mimeType:e.mimeType}))),s=this.currentComposeMessage.get("eventName")||"message",a=this.currentComposeMessage.get("acknowledgement");pm.runtime.socketIOPublish(this.connectionId,s,t,{acknowledgement:a},(()=>{const t={id:l()(),type:S.WEBSOCKET_OUTGOING_MESSAGE,payload:e.map(((e,t)=>({id:l()(),name:(0,g.getArgName)(t),value:e.content,meta:{mimeType:e.mimeType}}))),meta:{preview:(0,E.getMessagePreview)(S.WEBSOCKET_OUTGOING_MESSAGE,{message:v.get(e,[0,"content"]),mimeType:v.get(e,[0,"mimeType"])}),time:(new Date).toISOString(),eventName:s}};this.set("message",t)}))}_subscribe(e){this.status===S.CONNECTED&&pm.runtime.socketIOSubscribe(this.connectionId,e,(()=>{const t={id:l()(),type:f.SOCKETIO_SUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,E.getMessagePreview)(f.SOCKETIO_SUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:S.TEXT_PLAIN}};this.set("message",t)}))}subscribe(e){if(!e)return;const t=this.events.findIndex((t=>t.name===e)),s=-1!==t&&this.events[t];if(null!=s&&s.subscribeOnConnect)return;this._subscribe(e);const a=(0,c.toJS)(this.events);a[t].subscribeOnConnect=!0,this.set("events",a)}_unsubscribe(e){this.status===S.CONNECTED&&pm.runtime.socketIOUnsubscribe(this.connectionId,e,(()=>{const t={id:l()(),type:f.SOCKETIO_UNSUBSCRIBED_MESSAGE,payload:null,meta:{eventName:e,preview:(0,E.getMessagePreview)(f.SOCKETIO_UNSUBSCRIBED_MESSAGE),time:(new Date).toISOString(),mimeType:S.TEXT_PLAIN}};this.set("message",t)}))}unsubscribe(e,t=-1){if(!e)return;let s=-1;s=-1!==t?t:this.events.findIndex((t=>t.name===e));const a=-1!==s&&this.events[s];if(null==a||!a.subscribeOnConnect)return;this._unsubscribe(e);const n=(0,c.toJS)(this.events);n[s].subscribeOnConnect=!1,this.set("events",n)}toggleSubscription(e,t){t?this.subscribe(e):this.unsubscribe(e)}disconnect(e=!1){this.connectionId&&(this.set("status",S.DISCONNECTING),e&&this.onEnd({reason:"transport close"}),pm.runtime.socketIODisconnect(this.connectionId))}_deserializeMessages(e){return(0,g.deserializeMessages)(this.url,e)}}).editableAttributes={url:{defaultsTo:""},headers:{defaultsTo:[]},queryParams:{defaultsTo:[]},settings:{defaultsTo:{}},events:{defaultsTo:[]}},r.MessageClass=_.SocketIOComposeMessage,r.keysForFilterByType=["type"],r.keysForFilterByKeyword=["meta.eventName","payload.value","meta.preview"],M((i=r).prototype,"events",[c.computed],Object.getOwnPropertyDescriptor(i.prototype,"events"),i.prototype),M(i.prototype,"addArgument",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"addArgument"),i.prototype),M(i.prototype,"updateArgument",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"updateArgument"),i.prototype),M(i.prototype,"deleteArgument",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"deleteArgument"),i.prototype),M(i.prototype,"toggleAcknowledgement",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"toggleAcknowledgement"),i.prototype),M(i.prototype,"updateEventName",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"updateEventName"),i.prototype),M(i.prototype,"saveMediaFilePath",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"saveMediaFilePath"),i.prototype),M(i.prototype,"toggleExpanded",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"toggleExpanded"),i.prototype),M(i.prototype,"activeEventsCount",[c.computed],Object.getOwnPropertyDescriptor(i.prototype,"activeEventsCount"),i.prototype),M(i.prototype,"_subscribe",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"_subscribe"),i.prototype),M(i.prototype,"subscribe",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"subscribe"),i.prototype),M(i.prototype,"_unsubscribe",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"_unsubscribe"),i.prototype),M(i.prototype,"unsubscribe",[c.action],Object.getOwnPropertyDescriptor(i.prototype,"unsubscribe"),i.prototype),i)},12220:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var a,n=s(1),i=s(2399),r=s(2403),o=s.n(r),l=s(3194),c=s(2406),d=s(5462),p=s(40);const u=e=>{const t=(0,n.useRef)(null),s=(0,n.useRef)(null),[a,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{e.readOnly||s&&s.current&&s.current.scrollIntoView()}),[]),n.createElement("div",{className:o()("args-nav-bar-item",{"is-active":e.isActive}),onClick:()=>e.onSelect(e.index),onMouseOver:()=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{i(!0)}),200)},onMouseOut:()=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{i(!1)}),200)},ref:s},n.createElement(l.default,{type:"body-small",color:e.isActive?"content-color-primary":"content-color-secondary",isTruncated:!0},e.isActive?n.createElement(l.default,{type:"strong"},e.name):e.name),!e.readOnly&&!e.isLast&&a&&n.createElement("div",{className:"args-nav-bar-item__close",onClick:t=>{t&&t.stopPropagation(),e.onClose(e.index)}},n.createElement(c.default,{name:"icon-state-fail",color:"content-color-primary"})))},h=e=>n.createElement("div",{className:"args-nav-bar"},p.map(e.args,((t,s)=>n.createElement(u,{key:s,index:s,name:(0,d.getArgName)(s),isActive:e.activeArg===s,onSelect:e.onSelect,onClose:e.onClose,isLast:1===e.args.length,readOnly:e.readOnly}))));let m=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.onArgClose=this.onArgClose.bind(this)}componentDidMount(){this.props.onActiveArgChange&&this.props.onActiveArgChange(this.props.activeArg)}onArgClose(e){if(this.props.readOnly)return;const{args:t}=this.props;if(!(t&&t.length<=1)){if(e===this.props.activeArg){const t=e<=0?0:e-1;this.props.onActiveArgChange&&this.props.onActiveArgChange(t)}this.props.onArgClose(e)}}render(){return n.createElement("div",{className:o()("multi-arg-message-editor",this.props.className)},this.props.args.length>=2&&n.createElement(h,{activeArg:this.props.activeArg,args:this.props.args,onSelect:this.props.onActiveArgChange,onClose:this.onArgClose,readOnly:this.props.readOnly}),this.props.renderMessageContent(this.props.activeArg))}})||a},12232:function(e,t,s){s.r(t),s.d(t,{default:function(){return N}});var a,n=s(1),i=s(2399),r=s(2394),o=s.n(r),l=s(3573),c=s(4389),d=s(3184),p=s(2834),u=s(4898),h=s(2417),m=s(3594),E=s(5154),g=s(12217),S=s(12220),y=s(5463),_=s(5507),T=s(5464),f=s(40),b=s(7);const v={[T.WebSocketMessageBodyType.TEXT]:y.USER_FRIENDLY_LANGUAGE_NAME[T.WebSocketMessageBodyType.TEXT],[T.WebSocketMessageBodyType.POSTMAN_JSON]:y.USER_FRIENDLY_LANGUAGE_NAME[T.WebSocketMessageBodyType.POSTMAN_JSON],[T.WebSocketMessageBodyType.BINARY]:y.USER_FRIENDLY_LANGUAGE_NAME[T.WebSocketMessageBodyType.BINARY]},C={[T.WebSocketMessageBodySubType.BASE64]:y.USER_FRIENDLY_LANGUAGE_NAME[T.WebSocketMessageBodySubType.BASE64],[T.WebSocketMessageBodySubType.HEX]:y.USER_FRIENDLY_LANGUAGE_NAME[T.WebSocketMessageBodySubType.HEX]},M=[T.WebSocketMessageBodyType.TEXT,T.WebSocketMessageBodyType.BINARY],O={submit:"mod+enter"};const A=h.default.div.withConfig({displayName:"SocketIOCompose__AutoSuggestContainer",componentId:"postman-app__sc-h59y5v-0"})(["& .auto-suggest{& .auto-suggest-box{width:200px;font-family:var(--text-family-default);font-size:var(--text-size-m);color:var(--content-color-primary);background-color:unset;border:var(--border-width-default) var(--border-style-solid) var(--content-color-tertiary);border-radius:var(--border-radius-default);padding:7.5px 10px;background-color:unset;transition:border-color 0.2s ease-in-out,box-shadow 0.2s ease-in-out;&:hover{border-color:var(--content-color-tertiary);background-color:unset;}}&.is-focused{& .public-DraftStyleDefault-block{white-space:nowrap !important;}.auto-suggest-box{border:"," !important;box-shadow:",";}}& .public-DraftStyleDefault-block{height:var(--size-xs) !important;white-space:nowrap !important;}}"],(({theme:e})=>"light"===e.name?"var(--border-width-default) var(--border-style-solid) var(--blue-30)":"var(--border-width-default) var(--border-style-solid) var(--blue-50)"),(({theme:e})=>"light"===e.name?"0 0 0 2px var(--blue-30)":"0 0 0 2px var(--blue-50)"));let N=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.state={activeArg:0},this.getMessageEditor=this.getMessageEditor.bind(this),this.handleAddArgument=this.handleAddArgument.bind(this),this.handleArgUpdate=this.handleArgUpdate.bind(this),this.handleArgDelete=this.handleArgDelete.bind(this),this.handelArgValueChange=this.handelArgValueChange.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleSubTypeChange=this.handleSubTypeChange.bind(this),this.handleBeautify=this.handleBeautify.bind(this),this.handlePublishEventNameChange=this.handlePublishEventNameChange.bind(this),this.handleSend=this.handleSend.bind(this),this.handleActiveArgChange=this.handleActiveArgChange.bind(this),this.toggleAcknowledgement=this.toggleAcknowledgement.bind(this)}static getDerivedStateFromProps(e,t){const s=e.model.currentComposeMessage.get("args");return t.activeArg>=s.length?{activeArg:s.length-1}:null}getKeyMapHandlers(){return{submit:this.handleSend}}getMessageEditor(e,t){return n.createElement(d.default,{keyMap:O,handlers:this.getKeyMapHandlers()},n.createElement("div",{className:"socketIO-compose__multi-arg__editor","data-testid":"socketIO-compose-editor"},n.createElement(m.default,{fontSize:12,placeholder:"Compose message",onChange:this.handelArgValueChange.bind(this,t),language:this.showMessageSubTypes(e.type)?e.subtype:e.type,value:e.content,ref:e=>{this.editorRef=e},codeCompletionProviders:[{provider:E.default.bind(this)}]})))}showMessageSubTypes(e){return e===T.WebSocketMessageBodyType.BINARY}handleActiveArgChange(e){this.setState({activeArg:e})}handleAddArgument(){this.props.model.addArgument&&this.props.model.addArgument((e=>{this.handleActiveArgChange(e)}))}handleArgUpdate(e,t){this.props.model.updateArgument&&this.props.model.updateArgument(e,t)}handleArgDelete(e){this.props.model.deleteArgument&&this.props.model.deleteArgument(e)}handelArgValueChange(e,t){this.handleArgUpdate(e,{content:t})}handleTypeChange(e,t){const s={type:e};this.showMessageSubTypes(e)?null==t&&(s.subtype=T.WebSocketMessageBodySubType.BASE64):s.subtype=null,this.handleArgUpdate(this.state.activeArg,s)}handleSubTypeChange(e){this.handleArgUpdate(this.state.activeArg,{subtype:e})}handleBeautify(){this.editorRef&&this.editorRef.beautifyContent&&this.editorRef.beautifyContent()}handlePublishEventNameChange(e){this.props.model.updateEventName(e)}handleSend(){this.isSendDisabled||this.props.model.publish&&this.props.model.publish()}toggleAcknowledgement(){this.props.model.toggleAcknowledgement&&this.props.model.toggleAcknowledgement()}render(){let e;const{model:t}=this.props,s=t.currentComposeMessage.get("args"),{isDisabled:a,reason:i}=(0,_.isConnectDisabled)(t.type,t.url);this.isSendDisabled=!1,a?(this.isSendDisabled=!0,e=i):t.status!==y.CONNECTED&&t.status!==y.IDLE&&(this.isSendDisabled=!0);const r=window?f.includes(navigator.platform,"Mac"):"darwin"===b.platform,o=e||(r?"âŒ˜ â†µ":"Ctrl + Enter"),h=s[this.state.activeArg],m=h.type,E=h.subtype,T=this.showMessageSubTypes(m);return n.createElement("div",{className:"socketIO-compose"},n.createElement(S.default,{args:s,activeArg:this.state.activeArg,onActiveArgChange:this.handleActiveArgChange,onArgClose:this.handleArgDelete,className:"socketIO-compose__multi-arg",renderMessageContent:e=>this.getMessageEditor(s[e],e)}),n.createElement("div",{className:"socketIO-compose__footer"},n.createElement("div",{className:"socketIO-compose__footer__left"},n.createElement(l.default,{icon:"icon-action-add-stroke-small",text:"Arg",type:"tertiary",onClick:this.handleAddArgument}),n.createElement(g.default,{languageMap:v,activeLanguage:m,onChange:this.handleTypeChange}),T&&n.createElement(g.default,{languageMap:C,activeLanguage:E,onChange:this.handleSubTypeChange}),!f.includes(M,m)&&n.createElement(l.default,{onClick:this.handleBeautify,type:"tertiary",icon:"icon-action-pretty-stroke",tooltip:"Beautify"})),n.createElement("div",{className:"socketIO-compose__footer__right"},n.createElement(c.default,{isChecked:t.currentComposeMessage.get("acknowledgement"),onChange:this.toggleAcknowledgement,label:"Ack"}),n.createElement(d.default,{keyMap:O,handlers:this.getKeyMapHandlers()},n.createElement(A,null,n.createElement(p.AutoSuggestInput,{inputStyle:"box",placeholder:'Event name, defaults to "message"',allowFocus:!0,value:t.currentComposeMessage.get("eventName"),onChange:this.handlePublishEventNameChange,suggestions:(N=t.eventsCache.events,N?f.map(N,(e=>({value:e}))):[])}))),n.createElement(u.Button,{variant:t.status===y.CONNECTED?"cta":"secondary",tooltip:o,onClick:this.handleSend,isDisabled:this.isSendDisabled,"data-testid":"socketIO-sendMessage-button"},"Send"))));var N}})||a;N.contextTypes={variablesCache:o().object}},12218:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a,n=s(1),i=s(2399),r=s(5080),o=s(12207),l=s(12219),c=s(40);let d=(0,i.observer)(a=class extends n.Component{constructor(e){super(e),this.getListItem=this.getListItem.bind(this),this.handleMessageSelect=this.handleMessageSelect.bind(this),this.handleMediaSave=this.handleMediaSave.bind(this),this.handleListItemExpandAndCollapse=this.handleListItemExpandAndCollapse.bind(this)}getListItem(e,t){const{model:s}=this.props;return n.createElement(l.default,{key:t.id,index:e,message:t,color:s.eventsCache.getColor(c.get(t,"meta.eventName")),isSelected:s.selectedMessageSet.get(t.id),numberOfSelectedMessages:s.selectedMessageSet.size,cachedExpandedState:s.expandedMessageSet.get(t.id),mediaFilePath:s.messageMediaFilePaths.get(t.id),onMediaSave:this.handleMediaSave,toggleExpanded:this.handleListItemExpandAndCollapse,toggleMessageSelect:this.handleMessageSelect,saveMessage:s.saveMessageFromStream.bind(s),saveMessagesChecks:{isSavedRequest:s.isSavedRequest,isOnline:s.messageSDK.isOnline(),hasPermission:s.messageSDK.hasPermission(null,r.ItemAction.CREATE,!1,s.id)}})}handleMediaSave(e,t,s){this.props.model.saveMediaFilePath(e,t,s)}handleListItemExpandAndCollapse(e,t,s){this.props.model.toggleExpanded&&this.props.model.toggleExpanded(t,s),c.isNil(s)&&this.streamRef&&this.streamRef.handleResetHeight(e)}handleMessageSelect(e){this.props.model&&this.props.model.toggleMessageSelect(e)}render(){const{model:e}=this.props;return n.createElement(o.default,{ref:e=>{this.streamRef=e},model:e,renderListItem:this.getListItem,className:"socketIO-message-stream"})}})||a},12219:function(e,t,s){s.r(t);var a,n=s(1),i=s(3583),r=s.n(i),o=s(2399),l=s(1039),c=s(2403),d=s.n(c),p=s(2417),u=s(3194),h=s(3570),m=s(3573),E=s(3202),g=s(4389),S=s(6001),y=s(2406),_=s(3584),T=s(3590),f=s(3562),b=s(5508),v=s(12220),C=s(12216),M=s(5462),O=s(5461),A=s(5463),N=s(5464),w=s(40);let I=(0,o.observer)(a=class extends n.Component{constructor(e){super(e),this.state={isHovered:!1,forceEllipsifyPreview:!1},this.handleCopy=this.handleCopy.bind(this),this.handleSave=this.handleSave.bind(this),this.toggleSelect=this.toggleSelect.bind(this),this.toggleExpanded=this.toggleExpanded.bind(this),this.stopItemExpand=this.stopItemExpand.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleActiveArgChange=this.handleActiveArgChange.bind(this),this.getMessageBodyViewer=this.getMessageBodyViewer.bind(this),this.isPayloadEmpty=this.isPayloadEmpty.bind(this)}componentDidMount(){this.shouldForceEllipsifyPreview()}getClasses(e){return d()({"socketIO-stream-item":!0,"server-message":e===A.WEBSOCKET_INCOMING_MESSAGE,"client-message":e===A.WEBSOCKET_OUTGOING_MESSAGE,"no-body":this.isPayloadEmpty()})}getDataTestId(e){switch(e){case A.WEBSOCKET_INCOMING_MESSAGE:return"socketIO-server-message";case A.WEBSOCKET_OUTGOING_MESSAGE:return"socketIO-client-message"}}getPreviewMessageClasses(){return d()({"socketIO-stream-item__header__left-section__message":!0,"add-ellipsis":this.state.forceEllipsifyPreview,"is-placeholder":w.get(this.props.message,"meta.preview.placeholder")})}getMessageBodyViewer(e){const{value:t,meta:{mimeType:s,fileExtension:a}}=w.get(this.props.message,["payload",e]),i=A.MIME_TYPE_TO_MESSAGE_BODY_TYPE_MAP[s]||N.WebSocketMessageBodyType.TEXT,r=i===N.WebSocketMessageBodyType.HEXDUMP,o={activeLanguage:r?null:i,lineWrap:!1,hexMode:r};return n.createElement(C.default,{id:e,message:t,mimeType:s,fileExtension:a,mediaFilePath:w.get(this.props.mediaFilePath,[e]),cachedState:w.assign(o,w.get(this.props.cachedExpandedState,[e],{})),onMediaSave:this.handleMediaSave.bind(this,e),updateState:this.updateExpandedCachedState.bind(this,e)})}isPayloadEmpty(){return w.isEmpty(w.get(this.props.message,"payload"))}shouldForceEllipsifyPreview(){const e=this.previewRef;!w.get(this.props.message,"meta.preview.truncated")||!e||e.clientWidth<e.scrollWidth||this.setState({forceEllipsifyPreview:!0})}showCheckBox(e){return(e===A.WEBSOCKET_OUTGOING_MESSAGE||e===A.WEBSOCKET_INCOMING_MESSAGE)&&(this.state.isHovered||this.props.isSelected||this.props.numberOfSelectedMessages>0)}stopItemExpand(e){e&&e.stopPropagation()}toggleExpanded(){if(this.isPayloadEmpty())return;const{id:e}=this.props.message||{};this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,e)}updateExpandedCachedState(e,t){this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,this.props.message.id,{[e]:t})}toggleSelect(){const{id:e}=this.props.message||{};this.props.toggleMessageSelect&&this.props.toggleMessageSelect(e)}handleActiveArgChange(e){this.props.toggleExpanded&&this.props.toggleExpanded(this.props.index,this.props.message.id,{activeArg:e})}handleMediaSave(e,t){this.props.onMediaSave&&this.props.onMediaSave(this.props.message.id,e,t)}handleCopy(){const e=w.get(this.props.message,"payload"),{value:t}=w.first(e)||{};_.default.copy(t),pm.toasts.success("Copied to clipboard",{dedupeId:"message-copied-message"})}handleSave(){this.props.saveMessage&&(this.props.saveMessage((0,l.toJS)(this.props.message)),pm.toasts.success("Message saved",{dedupeId:"message-saved-message"}))}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){this.setState({isHovered:!1})}renderObjectInspector({error:e,handshakeDetails:t}){return n.createElement("div",{className:d()({"socketIO-stream-item__body__obj-inspector":!0,"no-details":w.isNil(t)})},e&&n.createElement("div",{className:"socketIO-stream-item__body__obj-inspector__error"},n.createElement(u.default,{type:"strong"},"Error:"),n.createElement("span",null," "),n.createElement(u.default,{type:"body-medium",color:"content-color-primary"},e)),t&&n.createElement(n.Fragment,null,n.createElement(h.default,{type:"h6",text:"Handshake Details",color:"content-color-secondary"}),n.createElement(T.default,{data:t})))}renderText(e){const{code:t,name:s,description:a}=e||{};let i;return t&&s?i=`${t} ${s}`:t?i=t:s&&(i=s),n.createElement("div",{className:"socketIO-stream-item__body__plain-text",title:a},i&&n.createElement(u.default,{type:"strong"},`${i}: `),n.createElement(u.default,{type:"body-medium",color:"content-color-secondary",className:"socketIO-stream-item__body__plain-text__description"},a))}renderBody(){if(this.isPayloadEmpty())return null;const{type:e,payload:t}=this.props.message||{};let s;switch(e){case A.WEBSOCKET_OUTGOING_MESSAGE:case A.WEBSOCKET_INCOMING_MESSAGE:s=n.createElement("div",{className:"socketIO-stream-item__body__message-body-viewer"},n.createElement(v.default,{args:t,activeArg:w.get(this.props.cachedExpandedState,"activeArg",0),onActiveArgChange:this.handleActiveArgChange,renderMessageContent:this.getMessageBodyViewer,readOnly:!0}));break;case A.WEBSOCKET_CONNECTED_MESSAGE:case A.WEBSOCKET_ERROR_MESSAGE:s=this.renderObjectInspector(t);break;case A.WEBSOCKET_DISCONNECTED_MESSAGE:default:s=this.renderText(t)}return n.createElement("div",{className:"socketIO-stream-item__body"},s)}renderHeaderRightSection(e,t={},s){const{time:a}=t,i=r()(a).format("HH:mm:ss"),{isSavedRequest:o,isOnline:l,hasPermission:c}=this.props.saveMessagesChecks||{},d=this.isPayloadEmpty()?null:n.createElement(y.default,{name:this.props.cachedExpandedState?"icon-direction-up":"icon-direction-down",color:"content-color-primary",size:"large"});let p=null;const h=i?n.createElement("div",{className:"socketIO-stream-item__header__right-section__time"},n.createElement(u.default,{type:"body-medium",color:"content-color-secondary"},i)):null;if(!this.state.isHovered||e!==A.WEBSOCKET_OUTGOING_MESSAGE&&e!==A.WEBSOCKET_INCOMING_MESSAGE)p=h;else{const e=!A.WEBSOCKET_MESSAGE_READABLE.has(w.get(s,[0,"meta","mimeType"]))||w.isEmpty(w.get(s,[0,"value"]));p=n.createElement(n.Fragment,null,n.createElement("div",{className:"socketIO-stream-item__header__right-section__quick-actions",onClick:this.stopItemExpand},n.createElement(m.default,{onClick:this.handleCopy,type:"tertiary",icon:"icon-action-copy-stroke",isDisabled:e,tooltip:n.createElement(E.default,{content:e?"Can't copy this message":"Copy "+(w.size(s)>1?"first argument":"message"),placement:"bottom"})}),n.createElement(m.default,{onClick:this.handleSave,type:"tertiary",icon:"icon-action-save-stroke",isDisabled:!l||!c||!o,tooltip:n.createElement(E.default,{content:l?o?c?"Save message":f.DISABLED_TOOLTIP_NO_PERMISSION:"Save this request to perform this action.":f.DISABLED_TOOLTIP_IS_OFFLINE,placement:"bottom"})})),h)}return n.createElement("div",{className:"socketIO-stream-item__header__right-section"},p,d)}renderHeader(){const{type:e,meta:t,payload:s}=this.props.message||{},a=A.MESSAGE_ICON_MAP[e]||A.MESSAGE_ICON_MAP.default||{},i=w.isFunction(a)?a((0,M.isNormalConnectionClose)(w.get(s,"name"))):a,{name:r,color:o,size:l}=i||{},c=t.eventName&&n.createElement(O.default,{name:t.eventName,color:this.props.color});let p;t&&(p=w.isString(t.preview)?t.preview:w.get(t.preview,"text"));const h=n.createElement(u.default,{type:"body-medium",className:this.getPreviewMessageClasses(),color:t.preview.placeholder?"content-color-secondary":"content-color-primary"},p),m=e===b.SOCKETIO_SUBSCRIBED_MESSAGE||e===b.SOCKETIO_UNSUBSCRIBED_MESSAGE?n.createElement(n.Fragment,null,h,c):n.createElement(n.Fragment,null,c,h);return n.createElement("div",{className:d()({"socketIO-stream-item__header":!0,"is-hovered":this.state.isHovered,"is-selected":this.props.isSelected}),onClick:this.toggleExpanded,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n.createElement("div",{className:"socketIO-stream-item__header__left-section",ref:e=>{this.previewRef=e}},this.showCheckBox(e)&&n.createElement("div",{className:"socketIO-stream-item__header__left-section__checkbox",onClick:this.stopItemExpand},n.createElement(g.default,{isChecked:this.props.isSelected,onChange:this.toggleSelect,isDisabled:!this.props.isSelected&&2===this.props.numberOfSelectedMessages})),r&&o&&n.createElement("div",{className:"socketIO-stream-item__header__left-section__type-icon"},n.createElement(y.default,{name:r,color:o,size:l})),m,w.isArray(s)&&w.size(s)>1&&n.createElement("div",{className:"socketIO-stream-item__header__left-section__arg-count-badge"},n.createElement(S.default,{className:"badge",text:`+${w.size(s)-1} ${2===w.size(s)?"Arg":"Args"}`}))),this.renderHeaderRightSection(e,t,s))}render(){const{type:e}=this.props.message||{};return n.createElement("div",{className:this.getClasses(e),"data-testid":this.getDataTestId(e)},this.renderHeader(),Boolean(this.props.cachedExpandedState)&&this.renderBody())}})||a;t.default=(0,p.withTheme)(I)}}]);